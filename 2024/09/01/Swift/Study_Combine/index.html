<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>combine学习 | shxlxa</title><meta name="author" content="shxlxa"><meta name="copyright" content="shxlxa"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Swift Combine - iOS 13轉移到 Combine 先做一個公用程式，印出範例用… 其實，Combine的功能有很大一部分是用到Result&lt;Value, Error&gt;的設定，成功和失敗二擇一的參數應用… Combine也是有所謂的生命週期 當然RxJS Marbles的彈珠圖也是可以參考的…  1234public func example(of descriptio">
<meta property="og:type" content="article">
<meta property="og:title" content="combine学习">
<meta property="og:url" content="https://shxlxa.github.io/2024/09/01/Swift/Study_Combine/index.html">
<meta property="og:site_name" content="shxlxa">
<meta property="og:description" content="Swift Combine - iOS 13轉移到 Combine 先做一個公用程式，印出範例用… 其實，Combine的功能有很大一部分是用到Result&lt;Value, Error&gt;的設定，成功和失敗二擇一的參數應用… Combine也是有所謂的生命週期 當然RxJS Marbles的彈珠圖也是可以參考的…  1234public func example(of descriptio">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2024-09-01T03:09:43.000Z">
<meta property="article:modified_time" content="2024-09-01T15:16:29.676Z">
<meta property="article:author" content="shxlxa">
<meta property="article:tag" content="combine">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://shxlxa.github.io/2024/09/01/Swift/Study_Combine/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'combine学习',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-01 23:16:29'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="shxlxa"><span class="site-name">shxlxa</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">combine学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-09-01T03:09:43.000Z" title="发表于 2024-09-01 11:09:43">2024-09-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-09-01T15:16:29.676Z" title="更新于 2024-09-01 23:16:29">2024-09-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/swift/">swift</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="combine学习"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="Swift-Combine-iOS-13"><a href="#Swift-Combine-iOS-13" class="headerlink" title="Swift Combine - iOS 13"></a><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/combine">Swift Combine - iOS 13</a></h1><h2 id="轉移到-Combine"><a href="#轉移到-Combine" class="headerlink" title="轉移到 Combine"></a><a target="_blank" rel="noopener" href="https://medium.com/jeremy-xue-s-blog/swift-%E8%BD%89%E7%A7%BB%E5%88%B0-combine-9b9cc91a0748">轉移到 Combine</a></h2><ul>
<li>先做一個<a target="_blank" rel="noopener" href="https://heckj.github.io/swiftui-notes/index_zh-CN.html">公用程式</a>，印出範例用…</li>
<li>其實，Combine的功能有很大一部分是用到<a target="_blank" rel="noopener" href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%88%90%E5%8A%9F%E5%92%8C%E5%A4%B1%E6%95%97%E4%BA%8C%E6%93%87%E4%B8%80%E7%9A%84-result-type-e234c6fccc9c">Result&lt;Value, Error&gt;</a>的設定，成功和失敗二擇一的參數應用…</li>
<li>Combine也是有所謂的<a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10217930">生命週期</a></li>
<li>當然<a target="_blank" rel="noopener" href="https://rxmarbles.com/">RxJS Marbles的彈珠圖</a>也是可以參考的…</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">func</span> <span class="title function_">example</span>(<span class="params">of</span> <span class="params">description</span>: <span class="type">String</span>, <span class="params">action</span>: () -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\n</span>=== 範例: <span class="subst">\(description)</span> ===&quot;</span>)</span><br><span class="line">    action()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Lesson-01-Notification-vs-Combine"><a href="#Lesson-01-Notification-vs-Combine" class="headerlink" title="Lesson.01 - Notification vs Combine"></a>Lesson.01 - Notification vs Combine</h2><h3 id="通知-Notification"><a href="#通知-Notification" class="headerlink" title="通知 - Notification"></a><a target="_blank" rel="noopener" href="https://www.appcoda.com.tw/notificationcenter/">通知 - Notification</a></h3><ul>
<li>先以一個iOS基本的Notification為基準</li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;Notification&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> myNotification <span class="operator">=</span> <span class="type">Notification</span>.<span class="type">Name</span>(<span class="string">&quot;MyNotification&quot;</span>)</span><br><span class="line">    <span class="keyword">let</span> center <span class="operator">=</span> <span class="type">NotificationCenter</span>.default</span><br><span class="line">    <span class="keyword">let</span> observer <span class="operator">=</span> center.addObserver(forName: myNotification, object: <span class="literal">nil</span>, queue: <span class="literal">nil</span>) &#123; notification <span class="keyword">in</span> <span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\(notification.object<span class="operator">!</span>)</span>&quot;</span>) &#125;</span><br><span class="line">    <span class="keyword">let</span> object <span class="operator">=</span> <span class="string">&quot;「張君雅小妹妹，恁兜的泡麵已經煮好了，恁阿嬤限妳一分鐘內趕緊回去呷；哪嘸，到時麵若爛去，伊是概不負責！」&quot;</span></span><br><span class="line">    </span><br><span class="line">    center.post(name: myNotification, object: object)</span><br><span class="line">    center.removeObserver(observer)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: Notification ===</span><br><span class="line">「張君雅小妹妹，恁兜的泡麵已經煮好了，恁阿嬤限妳一分鐘內趕緊回去呷；哪嘸，到時麵若爛去，伊是概不負責！」</span><br></pre></td></tr></table></figure>

<h3 id="發布者-Publisher"><a href="#發布者-Publisher" class="headerlink" title="發布者 - Publisher"></a><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/foundation/notificationcenter/publisher">發布者 - Publisher</a></h3><ul>
<li>可以類比成NotificationCenter.default.post()的功能</li>
<li>有發布訊息的功能 (單向)</li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;Publisher&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> myNotification <span class="operator">=</span> <span class="type">Notification</span>.<span class="type">Name</span>(<span class="string">&quot;MyNotification&quot;</span>)</span><br><span class="line">    <span class="keyword">let</span> center <span class="operator">=</span> <span class="type">NotificationCenter</span>.default</span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> center.publisher(for: myNotification, object: <span class="literal">nil</span>)</span><br><span class="line">    </span><br><span class="line">    center.post(name: myNotification, object: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="訂閱者-Subscriber"><a href="#訂閱者-Subscriber" class="headerlink" title="訂閱者 - Subscriber"></a>訂閱者 - Subscriber</h3><ul>
<li>可以類比成NotificationCenter.default.addObserver()的功能</li>
<li>有收接訊息的功能 (單向)</li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;Subscriber&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> myNotification <span class="operator">=</span> <span class="type">Notification</span>.<span class="type">Name</span>(<span class="string">&quot;MyNotification&quot;</span>)</span><br><span class="line">    <span class="keyword">let</span> center <span class="operator">=</span> <span class="type">NotificationCenter</span>.default</span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> center.publisher(for: myNotification, object: <span class="literal">nil</span>)</span><br><span class="line">    <span class="keyword">let</span> subscription <span class="operator">=</span> publisher.sink &#123; <span class="keyword">_</span> <span class="keyword">in</span> <span class="built_in">print</span>(<span class="string">&quot;收到從發布者傳來的通知了&quot;</span>) &#125;</span><br><span class="line">    </span><br><span class="line">    center.post(name: myNotification, object: <span class="literal">nil</span>)</span><br><span class="line">    subscription.cancel()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="我心中的Combine"><a href="#我心中的Combine" class="headerlink" title="我心中的Combine"></a>我心中的Combine</h2><p><img src="/../../source/images/Study_Combine/Combine.png"></p>
<h2 id="初學Publisher"><a href="#初學Publisher" class="headerlink" title="初學Publisher"></a>初學Publisher</h2><h3 id="Just"><a href="#Just" class="headerlink" title="Just"></a>Just</h3><ul>
<li>使用Combine時，最基本的Publisher</li>
<li>一個發布者，可由多個訂閱者接收</li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;Just&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> just <span class="operator">=</span> <span class="type">Just</span>(<span class="string">&quot;Hello world!&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> subscription_1 <span class="operator">=</span> just.sink(</span><br><span class="line">        receiveCompletion: &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Received completion: &quot;</span>, <span class="variable">$0</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        receiveValue: &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Received value: &quot;</span>, <span class="variable">$0</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> subscription_2 <span class="operator">=</span> just.sink(</span><br><span class="line">        receiveCompletion: &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Received completion (another): &quot;</span>, <span class="variable">$0</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        receiveValue: &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Received value (another): &quot;</span>, <span class="variable">$0</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    </span><br><span class="line">    subscription_1.cancel()</span><br><span class="line">    subscription_2.cancel()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: Just ===</span><br><span class="line">Received value:  Hello world!</span><br><span class="line">Received completion:  finished</span><br><span class="line">Received value (another):  Hello world!</span><br><span class="line">Received completion (another):  finished</span><br></pre></td></tr></table></figure>

<h2 id="Combine運算子"><a href="#Combine運算子" class="headerlink" title="Combine運算子"></a>Combine運算子</h2><h3 id="儲存數值-assign-to-on"><a href="#儲存數值-assign-to-on" class="headerlink" title="儲存數值 - assign(to:on:)"></a><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/combine/just/assign(to:on:&#41;">儲存數值 - assign(to:on:)</a></h3><ul>
<li>萬物都可以轉成Publisher，試著把Array轉成Publisher</li>
<li>利用assign(to:on:)，把發布者發布的值存到變數裡面</li>
<li>從didSet()取值 &#x3D;&gt; <a target="_blank" rel="noopener" href="https://davidlinnn.medium.com/swift-4-kvo-%E7%AD%86%E8%A8%98-4c89a996e022">KVO - Key-Value Observing</a></li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;assign(to:on:)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">SomeObject</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> value: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">            <span class="keyword">didSet</span> &#123; <span class="built_in">print</span>(value) &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> array <span class="operator">=</span> [<span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;world!&quot;</span>]</span><br><span class="line">    <span class="keyword">let</span> object <span class="operator">=</span> <span class="type">SomeObject</span>()</span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> array.publisher</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">_</span> <span class="operator">=</span> publisher.assign(to: \.value, on: object)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: assign(to:on:) ===</span><br><span class="line">Hello</span><br><span class="line">world!</span><br></pre></td></tr></table></figure>

<h3 id="儲存數值-assign-to"><a href="#儲存數值-assign-to" class="headerlink" title="儲存數值 - assign(to:)"></a><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/combine/just/assign(to:&#41;">儲存數值 - assign(to:)</a></h3><ul>
<li>這是個相當經典的例子</li>
<li>利用<a target="_blank" rel="noopener" href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/swiftui-%E4%BB%80%E9%BA%BC%E6%98%AF-published-observableobject-eb950f8295a">@Published</a>，將變數value轉成Publisher，這時候的value就要用$value來處理</li>
<li>而要存到變數value，就要使用&amp;object來處理</li>
<li>使用<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/combine/just/sink(receivevalue:&#41;">sink()</a>取值，而不是從數值去取值了</li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;assign(to:)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">SomeObject</span> &#123;</span><br><span class="line">        <span class="meta">@Published</span> <span class="keyword">var</span> value <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> object <span class="operator">=</span> <span class="type">SomeObject</span>()</span><br><span class="line">    object.<span class="variable">$value</span>.sink &#123; <span class="built_in">print</span>(<span class="string">&quot;收到的值為: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;</span><br><span class="line">    </span><br><span class="line">    (<span class="number">0</span><span class="operator">..&lt;</span><span class="number">10</span>).publisher.assign(to: <span class="operator">&amp;</span>object.<span class="variable">$value</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: assign(to:) ===</span><br><span class="line">收到的值為: 0</span><br><span class="line">收到的值為: 0</span><br><span class="line">收到的值為: 1</span><br><span class="line">收到的值為: 2</span><br><span class="line">收到的值為: 3</span><br><span class="line">收到的值為: 4</span><br><span class="line">收到的值為: 5</span><br><span class="line">收到的值為: 6</span><br><span class="line">收到的值為: 7</span><br><span class="line">收到的值為: 8</span><br><span class="line">收到的值為: 9</span><br></pre></td></tr></table></figure>

<h3 id="自訂Subscriber"><a href="#自訂Subscriber" class="headerlink" title="自訂Subscriber"></a>自訂Subscriber</h3><ul>
<li>只要使用協定Subscriber就可以自己產生一個自訂Subscriber</li>
<li>如果使用subscription.request(.max(3)) + return .none，就只會印三個，而且不會結束</li>
<li>但如果把return .none改成return .unlimited，就只會印全部，而且會結束</li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;Custom Subscriber&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">MagazineSubscriber</span>: <span class="title class_">Subscriber</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">typealias</span> <span class="type">Input</span> <span class="operator">=</span> <span class="type">String</span>                                <span class="comment">// 雜誌名稱是文字</span></span><br><span class="line">        <span class="keyword">typealias</span> <span class="type">Failure</span> <span class="operator">=</span> <span class="type">Never</span>                               <span class="comment">// 不處理錯誤</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">let</span> maxCount <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">var</span> count <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">var</span> subscription: <span class="type">Subscription</span>?</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">receive</span>(<span class="params">subscription</span>: <span class="type">Subscription</span>) &#123;</span><br><span class="line">            <span class="built_in">print</span>(subscription)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">self</span>.subscription <span class="operator">=</span> subscription                    <span class="comment">// 在這裡，你可以保存subscription，並告訴出版社你要接收雜誌</span></span><br><span class="line">            subscription.request(.unlimited)                    <span class="comment">// 請求出版商無限制數量的雜誌</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">receive</span>(<span class="keyword">_</span> <span class="params">input</span>: <span class="type">Input</span>) -&gt; <span class="type">Subscribers</span>.<span class="type">Demand</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Received value&quot;</span>, input, count)               <span class="comment">// 在這裡，你可以處理收到的雜誌內容</span></span><br><span class="line">            count <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (count <span class="operator">&gt;=</span> maxCount) &#123; subscription<span class="operator">?</span>.cancel() &#125;   <span class="comment">// 它表明訂閱者不再需要額外的項目 (目標到達，取消訂閱)</span></span><br><span class="line">            <span class="keyword">return</span> .unlimited                                   <span class="comment">// 請求接收更多的雜誌</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">receive</span>(<span class="params">completion</span>: <span class="type">Subscribers</span>.<span class="type">Completion</span>&lt;<span class="type">Never</span>&gt;) &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Received completion&quot;</span>, completion)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> magazines <span class="operator">=</span> [<span class="string">&quot;ABC互動英語&quot;</span>, <span class="string">&quot;LIVE互動英語&quot;</span>, <span class="string">&quot;CNN互動英語&quot;</span>, <span class="string">&quot;互動日本語&quot;</span>, <span class="string">&quot;跟我一起學日語&quot;</span>, <span class="string">&quot;KOREA韓語學習誌&quot;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> magazines.publisher                         <span class="comment">// Array =&gt; Publisher</span></span><br><span class="line">    <span class="keyword">let</span> subscriber <span class="operator">=</span> <span class="type">MagazineSubscriber</span>()</span><br><span class="line"></span><br><span class="line">    publisher.subscribe(subscriber)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: Custom Subscriber ===</span><br><span class="line">[<span class="string">&quot;ABC互動英語&quot;</span>, <span class="string">&quot;LIVE互動英語&quot;</span>, <span class="string">&quot;CNN互動英語&quot;</span>, <span class="string">&quot;互動日本語&quot;</span>, <span class="string">&quot;跟我一起學日語&quot;</span>, <span class="string">&quot;KOREA韓語學習誌&quot;</span>]</span><br><span class="line">Received value ABC互動英語 0</span><br><span class="line">Received value LIVE互動英語 1</span><br><span class="line">Received value CNN互動英語 2</span><br></pre></td></tr></table></figure>

<h2 id="Publisher"><a href="#Publisher" class="headerlink" title="Publisher"></a>Publisher</h2><h3 id="Future-非同步Publisher"><a href="#Future-非同步Publisher" class="headerlink" title="Future - 非同步Publisher"></a><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/combine/future">Future - 非同步Publisher</a></h3><ul>
<li>聽名字就知道，接收未來資料與事件<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c5dbc67fcfcb">非同步</a>的Publisher</li>
<li>在這裡我們讓它停止3秒，再顯示值</li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> subscriptions <span class="operator">=</span> <span class="type">Set</span>&lt;<span class="type">AnyCancellable</span>&gt;()</span><br><span class="line">example(of: <span class="string">&quot;Future&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">futureIncrement</span>(<span class="params">integer</span>: <span class="type">Int</span>, <span class="params">afterDelay</span> <span class="params">delay</span>: <span class="type">UInt32</span>) -&gt; <span class="type">Future</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt; &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">Future</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt; &#123; promise <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Original =&gt; <span class="subst">\(integer)</span>&quot;</span>)</span><br><span class="line">            sleep(delay)</span><br><span class="line">            promise(.success(integer <span class="operator">+</span> <span class="number">1</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> future <span class="operator">=</span> futureIncrement(integer: <span class="number">1</span>, afterDelay: <span class="number">3</span>)</span><br><span class="line">    </span><br><span class="line">    future</span><br><span class="line">        .sink(receiveCompletion: &#123; <span class="built_in">print</span>(<span class="string">&quot;Completion =&gt; <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;, receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;Value =&gt; <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    future</span><br><span class="line">        .sink(receiveCompletion: &#123; <span class="built_in">print</span>(<span class="string">&quot;Completion =&gt; <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;, receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;Value =&gt; <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: Future ===</span><br><span class="line">Original =&gt; 1</span><br><span class="line">Value =&gt; 2</span><br><span class="line">Completion =&gt; finished</span><br><span class="line">Value =&gt; 2</span><br><span class="line">Completion =&gt; finished</span><br></pre></td></tr></table></figure>

<h2 id="Subject-Publisher-延展類"><a href="#Subject-Publisher-延展類" class="headerlink" title="Subject - Publisher 延展類"></a><a target="_blank" rel="noopener" href="https://louyu.cc/articles/ios-swift/2021/03/?p=2857/">Subject - Publisher 延展類</a></h2><h3 id="PassthroughSubject"><a href="#PassthroughSubject" class="headerlink" title="PassthroughSubject"></a><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10219418">PassthroughSubject</a></h3><ul>
<li>與之前我們討論的 Publisher 不同的是，Subject 的最大特點就是可以手動傳送資料</li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;PassthroughSubject&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">MyError</span>: <span class="title class_">Error</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> test</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">StringSubscriber</span>: <span class="title class_">Subscriber</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">typealias</span> <span class="type">Input</span> <span class="operator">=</span> <span class="type">String</span></span><br><span class="line">        <span class="keyword">typealias</span> <span class="type">Failure</span> <span class="operator">=</span> <span class="type">MyError</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">receive</span>(<span class="params">subscription</span>: <span class="type">Subscription</span>) &#123;</span><br><span class="line">            subscription.request(.max(<span class="number">2</span>))</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">receive</span>(<span class="keyword">_</span> <span class="params">input</span>: <span class="type">String</span>) -&gt; <span class="type">Subscribers</span>.<span class="type">Demand</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Received value (input): &quot;</span>, input)</span><br><span class="line">            <span class="keyword">return</span> input <span class="operator">==</span> <span class="string">&quot;World&quot;</span> <span class="operator">?</span> .max(<span class="number">1</span>) : .none</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">receive</span>(<span class="params">completion</span>: <span class="type">Subscribers</span>.<span class="type">Completion</span>&lt;<span class="type">MyError</span>&gt;) &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Received completion (input): &quot;</span>, completion)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subscriber <span class="operator">=</span> <span class="type">StringSubscriber</span>()</span><br><span class="line">    <span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">String</span>, <span class="type">MyError</span>&gt;()</span><br><span class="line"></span><br><span class="line">    subject.subscribe(subscriber)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subscription <span class="operator">=</span> subject</span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; completion <span class="keyword">in</span> <span class="built_in">print</span>(<span class="string">&quot;Received completion (sink): &quot;</span>, completion) &#125;,</span><br><span class="line">            receiveValue: &#123; value <span class="keyword">in</span> <span class="built_in">print</span>(<span class="string">&quot;Received value (sink): &quot;</span>, value) &#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    subject.send(<span class="string">&quot;Hello&quot;</span>)</span><br><span class="line">    subject.send(<span class="string">&quot;World&quot;</span>)</span><br><span class="line"></span><br><span class="line">    subscription.cancel()</span><br><span class="line"></span><br><span class="line">    subject.send(<span class="string">&quot;Still there?&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// subject.send(completion: .failure(MyError.test))</span></span><br><span class="line">    subject.send(completion: .finished)</span><br><span class="line"></span><br><span class="line">    subject.send(<span class="string">&quot;How about another one?&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: PassthroughSubject ===</span><br><span class="line">Received value (sink):  Hello</span><br><span class="line">Received value (input):  Hello</span><br><span class="line">Received value (sink):  World</span><br><span class="line">Received value (input):  World</span><br><span class="line">Received value (input):  Still there?</span><br><span class="line">Received completion:  finished</span><br></pre></td></tr></table></figure>

<h3 id="CurrentValueSubject-Publisher-延展類"><a href="#CurrentValueSubject-Publisher-延展類" class="headerlink" title="CurrentValueSubject - Publisher 延展類"></a><a target="_blank" rel="noopener" href="https://www.avanderlee.com/combine/passthroughsubject-currentvaluesubject-explained/">CurrentValueSubject - Publisher 延展類</a></h3><ul>
<li>與 PassthroughSubject 不同，CurrentValueSubject 會保留一個最後的資料，並在被訂閱時將這個資料傳送給下游的 Publisher 或 Subscriber。</li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;CurrentValueSubject&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">CurrentValueSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;(<span class="number">0</span>)	<span class="comment">// 設定初值</span></span><br><span class="line">    </span><br><span class="line">    subject</span><br><span class="line">        .print()</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;First subscription: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    subject.send(<span class="number">1</span>)</span><br><span class="line">    subject.send(<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(subject.value)</span><br><span class="line">    </span><br><span class="line">    subject.value <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">    <span class="built_in">print</span>(subject.value)</span><br><span class="line"></span><br><span class="line">    subject</span><br><span class="line">        .print()</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;Second subscription:&quot;</span>, <span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    subject.send(completion: .finished)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: CurrentValueSubject ===</span><br><span class="line">receive subscription: (CurrentValueSubject)</span><br><span class="line">request unlimited</span><br><span class="line">receive value: (0)</span><br><span class="line">First subscription: 0</span><br><span class="line">receive value: (1)</span><br><span class="line">First subscription: 1</span><br><span class="line">receive value: (2)</span><br><span class="line">First subscription: 2</span><br><span class="line">2</span><br><span class="line">receive value: (3)</span><br><span class="line">First subscription: 3</span><br><span class="line">3</span><br><span class="line">receive subscription: (CurrentValueSubject)</span><br><span class="line">request unlimited</span><br><span class="line">receive value: (3)</span><br><span class="line">Second subscription: 3</span><br><span class="line">receive finished</span><br><span class="line">receive finished</span><br></pre></td></tr></table></figure>

<h3 id="自動校正Demand"><a href="#自動校正Demand" class="headerlink" title="自動校正Demand"></a><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/combine/subscribers/demand">自動校正Demand</a></h3><ul>
<li>這裡是自動根據輸入的值，去改變Subscribers.Demand</li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;Dynamically adjusting Demand&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">IntSubscriber</span>: <span class="title class_">Subscriber</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">typealias</span> <span class="type">Input</span> <span class="operator">=</span> <span class="type">Int</span></span><br><span class="line">        <span class="keyword">typealias</span> <span class="type">Failure</span> <span class="operator">=</span> <span class="type">Never</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">receive</span>(<span class="params">subscription</span>: <span class="type">Subscription</span>) &#123;</span><br><span class="line">            subscription.request(.max(<span class="number">3</span>))   <span class="comment">// .max(3): 初始值</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">receive</span>(<span class="keyword">_</span> <span class="params">input</span>: <span class="type">Int</span>) -&gt; <span class="type">Subscribers</span>.<span class="type">Demand</span> &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Received value&quot;</span>, input)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">switch</span> input &#123;                  <span class="comment">// 累加的 =&gt;</span></span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>: <span class="keyword">return</span> .max(<span class="number">2</span>)          <span class="comment">// .max(3) + .max(2) = .max(4)</span></span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>: <span class="keyword">return</span> .max(<span class="number">1</span>)          <span class="comment">// .max(4) + .max(1) = .max(5)</span></span><br><span class="line">            <span class="keyword">default</span>: <span class="keyword">return</span> .none           <span class="comment">// .max(5)</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">func</span> <span class="title function_">receive</span>(<span class="params">completion</span>: <span class="type">Subscribers</span>.<span class="type">Completion</span>&lt;<span class="type">Never</span>&gt;) &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Received completion: &quot;</span>, completion)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> subscriber <span class="operator">=</span> <span class="type">IntSubscriber</span>()</span><br><span class="line">    <span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    subject.subscribe(subscriber)</span><br><span class="line">    </span><br><span class="line">    (<span class="number">1</span><span class="operator">...</span><span class="number">10</span>).forEach &#123; subject.send(<span class="variable">$0</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: Dynamically adjusting Demand ===</span><br><span class="line">Received value 1</span><br><span class="line">Received value 2</span><br><span class="line">Received value 3</span><br><span class="line">Received value 4</span><br><span class="line">Received value 5</span><br><span class="line">Received value 6</span><br></pre></td></tr></table></figure>

<h3 id="eraseToAnyPublisher"><a href="#eraseToAnyPublisher" class="headerlink" title="eraseToAnyPublisher()"></a><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/combine/publisher/erasetoanypublisher(;&#41">eraseToAnyPublisher()</a></h3><ul>
<li>轉成AnyPublisher</li>
<li>讓Publisher的類型<a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10221967">簡單化</a></li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;Type erasure&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()  <span class="comment">// PassthroughSubject&lt;Int, Never&gt;</span></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> subject.eraseToAnyPublisher()   <span class="comment">// PassthroughSubject&lt;Int, Never&gt; =&gt; AnyPublisher&lt;Int, Never&gt;</span></span><br><span class="line">    </span><br><span class="line">    publisher</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    subject.send(<span class="number">0</span>)</span><br><span class="line">    <span class="comment">// publisher.send(1)    // ∵ 轉成了AnyPublisher&lt;Int, Never&gt; ∴ 沒有send()</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: Type erasure ===</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h3 id="async-await"><a href="#async-await" class="headerlink" title="async &#x2F; await"></a>async &#x2F; await</h3><ul>
<li>非同步使用的範例</li>
<li></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;async / await&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">CurrentValueSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;(<span class="number">0</span>)    <span class="comment">// 設定初值 = 0</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">Task</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> <span class="keyword">await</span> element <span class="keyword">in</span> subject.values &#123; <span class="built_in">print</span>(<span class="string">&quot;Element: <span class="subst">\(element)</span>&quot;</span>) &#125;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Completed.&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    sleep(<span class="number">2</span>)</span><br><span class="line">    subject.send(<span class="number">1</span>)     <span class="comment">// 可以使用在非同步之上</span></span><br><span class="line">    sleep(<span class="number">2</span>)</span><br><span class="line">    subject.send(<span class="number">2</span>)</span><br><span class="line">    sleep(<span class="number">2</span>)</span><br><span class="line">    subject.send(<span class="number">3</span>)</span><br><span class="line">    </span><br><span class="line">    subject.send(completion: .finished)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: async / await ===</span><br><span class="line">Element: 0</span><br><span class="line">Element: 1</span><br><span class="line">Element: 2</span><br><span class="line">Element: 3</span><br><span class="line">Completed.</span><br></pre></td></tr></table></figure>

<h2 id="Lesson-02-Operators也是Publisher"><a href="#Lesson-02-Operators也是Publisher" class="headerlink" title="Lesson.02 - Operators也是Publisher"></a>Lesson.02 - Operators也是Publisher</h2><h3 id="collect"><a href="#collect" class="headerlink" title="collect()"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7017265258263740424">collect()</a></h3><ul>
<li>將單一值做分組…</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;collect&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> array <span class="operator">=</span> [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>]</span><br><span class="line">    </span><br><span class="line">    array.publisher</span><br><span class="line">        .collect(<span class="number">2</span>)     <span class="comment">// 2個2個一組，預設是1組；如果不加它的話，就是一個一個單獨輸出</span></span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: collect ===</span><br><span class="line">[<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>]</span><br><span class="line">[<span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>]</span><br><span class="line">[<span class="string">&quot;E&quot;</span>]</span><br><span class="line">finished</span><br></pre></td></tr></table></figure>

<h3 id="map"><a href="#map" class="headerlink" title="map()"></a><a target="_blank" rel="noopener" href="https://cocoacasts.com/combine-essentials-how-to-use-combine-map-and-compactmap-operators">map()</a></h3><ul>
<li>其實這個跟swift的<a target="_blank" rel="noopener" href="https://franksios.medium.com/swift3-%E9%AB%98%E9%9A%8E%E5%87%BD%E6%95%B8-higher-order-function-a97cf4577a11">高階函數 - map</a>很像，把值一個個處理，然後轉成另一種數值…</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;map&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> array <span class="operator">=</span> [<span class="number">123</span>, <span class="number">4</span>, <span class="number">56</span>]</span><br><span class="line">    <span class="keyword">let</span> formatter <span class="operator">=</span> <span class="type">NumberFormatter</span>()</span><br><span class="line">    </span><br><span class="line">    formatter.numberStyle <span class="operator">=</span> .spellOut</span><br><span class="line">    </span><br><span class="line">    array.publisher</span><br><span class="line">        .map(&#123; value <span class="keyword">in</span></span><br><span class="line">            formatter.string(for: <span class="type">NSNumber</span>(integerLiteral: value)) <span class="operator">??</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: map ===</span><br><span class="line">one hundred twenty-three</span><br><span class="line">four</span><br><span class="line">fifty-six</span><br></pre></td></tr></table></figure>

<ul>
<li>使用座標(x,y)當成map()的範例</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;mapping key paths&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Coordinate</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    publisher</span><br><span class="line">        .map(\.x, \.y)      <span class="comment">// 也可以這樣取值 (Coordinate.x / Coordinate.y)</span></span><br><span class="line">        .sink(receiveValue: &#123; x, y <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> quadrant <span class="operator">=</span> quadrantOf(x: x, y: y) <span class="keyword">else</span> &#123; <span class="built_in">print</span>(<span class="string">&quot;座標在 (<span class="subst">\(x)</span>, <span class="subst">\(y)</span>) 在軸上&quot;</span>); <span class="keyword">return</span> &#125;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;座標在 (<span class="subst">\(x)</span>, <span class="subst">\(y)</span>) 第<span class="subst">\(quadrant)</span>象限&quot;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    publisher.send(<span class="type">Coordinate</span>(x: <span class="number">10</span>, y: <span class="operator">-</span><span class="number">8</span>))</span><br><span class="line">    publisher.send(<span class="type">Coordinate</span>(x: <span class="number">0</span>, y: <span class="number">5</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: mapping key paths ===</span><br><span class="line">座標在 (10, -8) 第4象限</span><br><span class="line">座標在 (0, 5) 在軸上</span><br></pre></td></tr></table></figure>

<h3 id="tryMap"><a href="#tryMap" class="headerlink" title="tryMap()"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7023214404007264263">tryMap()</a></h3><ul>
<li>有錯誤處理的map</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;tryMap&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">Just</span>(<span class="string">&quot;資料夾名稱不存在!!!&quot;</span>)</span><br><span class="line">        .tryMap &#123; <span class="keyword">try</span> <span class="type">FileManager</span>.default.contentsOfDirectory(atPath: <span class="variable">$0</span>) &#125;</span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="built_in">print</span>(<span class="string">&quot;Completion: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;ReceiveValue: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: tryMap ===</span><br><span class="line">Completion: failure(Error Domain=NSCocoaErrorDomain Code=260 <span class="string">&quot;The folder “資料夾名稱不存在!!!” doesn’t exist.&quot;</span> UserInfo=&#123;NSUserStringVariant=(</span><br><span class="line">    Folder</span><br><span class="line">), NSFilePath=資料夾名稱不存在!!!, NSUnderlyingError=0x600003aff900 &#123;Error Domain=NSPOSIXErrorDomain Code=2 <span class="string">&quot;No such file or directory&quot;</span>&#125;&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap()"></a><a target="_blank" rel="noopener" href="https://kingnight.github.io/programming/2020/10/29/Combine%E4%B8%AD%E9%87%8D%E8%A6%81%E5%87%BD%E6%95%B0flatMap.html">flatMap()</a></h3><ul>
<li>字如其義，就是扁平化的意思 - flat，把Publishers &#x3D;&gt; 單一個Publisher (Publisher轉換)</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;flatMap&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">decode</span>(<span class="keyword">_</span> <span class="params">codes</span>: [<span class="type">Int</span>]) -&gt; <span class="type">AnyPublisher</span>&lt;<span class="type">String</span>, <span class="type">Never</span>&gt; &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">Just</span>(codes.compactMap &#123; code <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span> (<span class="number">32</span><span class="operator">...</span><span class="number">255</span>).contains(code) <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">String</span>(<span class="type">UnicodeScalar</span>(code) <span class="operator">??</span> <span class="string">&quot; &quot;</span>)</span><br><span class="line">        &#125;.joined())</span><br><span class="line">        .eraseToAnyPublisher()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> array <span class="operator">=</span> [<span class="number">72</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">44</span>, <span class="number">32</span>, <span class="number">87</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">108</span>, <span class="number">100</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">33</span>]    <span class="comment">/// Hello, World!!! (ASCII)</span></span><br><span class="line">    </span><br><span class="line">    array.publisher</span><br><span class="line">        .collect()</span><br><span class="line">        .flatMap(decode)                                                                <span class="comment">/// 可以接收一個個數值 Publishers =&gt; 單一個Publisher</span></span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: flatMap ===</span><br><span class="line">Hello, World!!!</span><br></pre></td></tr></table></figure>

<h3 id="replaceNil-with"><a href="#replaceNil-with" class="headerlink" title="replaceNil(with:)"></a><a target="_blank" rel="noopener" href="https://cocoacasts.com/combine-essentials-how-to-use-combine%27s-replacenil-operator">replaceNil(with:)</a></h3><ul>
<li>字如其義，就是處理nil值，有點像 (value ?? “-“)</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 06. 處理nil數值 =&gt; 有點像 (value ?? &quot;-&quot;)</span></span><br><span class="line">example(of: <span class="string">&quot;replaceNil&quot;</span>) &#123;</span><br><span class="line">    [<span class="string">&quot;A&quot;</span>, <span class="literal">nil</span>, <span class="string">&quot;C&quot;</span>].publisher</span><br><span class="line">        .eraseToAnyPublisher()</span><br><span class="line">        .replaceNil(with: <span class="string">&quot;-&quot;</span>)      <span class="comment">/// 可以試試不使用它的結果</span></span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: replaceNil ===</span><br><span class="line">A</span><br><span class="line">-</span><br><span class="line">C</span><br></pre></td></tr></table></figure>

<h3 id="replaceEmpty-with"><a href="#replaceEmpty-with" class="headerlink" title="replaceEmpty(with:)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7017356750735015966">replaceEmpty(with:)</a></h3><ul>
<li><p>字如其義，就是處理空值，用在演示或測試用</p>
</li>
<li><pre><code class="swift">example(of: &quot;replaceEmpty(with:)&quot;) &#123;
  
  let empty = Empty&lt;String, Never&gt;()
  
  empty
      .replaceEmpty(with: &quot;Test&quot;)      /// 可以試試不使用它的結果
      .sink(
          receiveCompletion: &#123; print($0) &#125;,
          receiveValue: &#123; print($0) &#125;
      )
      .store(in: &amp;subscriptions)
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: replaceEmpty(with:) ===</span><br><span class="line">Test</span><br><span class="line">finished</span><br></pre></td></tr></table></figure>

<h3 id="scan-https-juejin-cn-s-swift-combine-scan-example"><a href="#scan-https-juejin-cn-s-swift-combine-scan-example" class="headerlink" title="[scan()](https://juejin.cn/s/swift combine scan example)"></a>[scan()](<a target="_blank" rel="noopener" href="https://juejin.cn/s/swift">https://juejin.cn/s/swift</a> combine scan example)</h3><ul>
<li><p>累加之用，很像<a target="_blank" rel="noopener" href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/array-%E7%9A%84%E9%AB%98%E9%9A%8E%E5%87%BD%E5%BC%8F-filter-map-and-reduce-39fb8ba5a9f7">reduce()</a></p>
</li>
<li><pre><code class="swift">example(of: &quot;scan&quot;) &#123;
  
  let initValue = 50
  let maxCount = 10
  var dailyGainLoss: Int &#123; .random(in: -maxCount...maxCount) &#125;    /// 將產生-10 ~ 10的隨時數
  
  let june2023 = (0..&lt;maxCount)                                   /// 產生10組
      .map &#123; _ in dailyGainLoss &#125;                                 /// [Int]
      .publisher
  
  june2023
      .scan(initValue) &#123; latest, current in
          max(0, latest + current)                                /// 累加
      &#125;
      .sink(receiveValue: &#123; _ in &#125;)
      .store(in: &amp;subscriptions)
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<p><img src="/image/Scan.png"></p>
<h2 id="Lesson-03-過濾用的Operator"><a href="#Lesson-03-過濾用的Operator" class="headerlink" title="Lesson.03 - 過濾用的Operator"></a>Lesson.03 - 過濾用的Operator</h2><h3 id="filter"><a href="#filter" class="headerlink" title="filter()"></a><a target="_blank" rel="noopener" href="https://www.kodeco.com/books/combine-asynchronous-programming-with-swift/v2.0/chapters/4-filtering-operators">filter()</a></h3><ul>
<li>過濾之用，跟<a target="_blank" rel="noopener" href="https://www.inote.tw/swift-array-filter">filter()</a>很像</li>
<li><pre><code class="swift">
</code></pre>
</li>
</ul>
<p>example(of: “filter”) {</p>
<pre><code>let multiple = 3
let numbers = (1...10).publisher

numbers
    .filter &#123; $0.isMultiple(of: multiple) &#125;
    .sink(receiveValue: &#123; number in print(&quot;\(number) 是 \(multiple) 的倍數 !!!&quot;)&#125;)
    .store(in: &amp;subscriptions)
</code></pre>
<p>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```bash</span><br><span class="line">=== 範例: filter ===</span><br><span class="line">3 是 3 的倍數 !!!</span><br><span class="line">6 是 3 的倍數 !!!</span><br><span class="line">9 是 3 的倍數 !!!</span><br></pre></td></tr></table></figure>

<h3 id="removeDuplicates"><a href="#removeDuplicates" class="headerlink" title="removeDuplicates()"></a><a target="_blank" rel="noopener" href="https://paigeshin1991.medium.com/swift-combine-removeduplicates-you-can-totally-misuse-it-if-you-dont-read-this-9bf9c3c36296">removeDuplicates()</a></h3><ul>
<li>取得非重複資料，跟SQL的<a target="_blank" rel="noopener" href="https://www.fooish.com/sql/distinct.html">SELECT DISTINCT</a>功能很像</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;removeDuplicates&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> words <span class="operator">=</span> <span class="string">&quot;hey hey there! want to listen to mister mister ?&quot;</span></span><br><span class="line">                  .components(separatedBy: <span class="string">&quot; &quot;</span>)</span><br><span class="line">                  .publisher</span><br><span class="line">  words</span><br><span class="line">    .removeDuplicates()</span><br><span class="line">    .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">    .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hey</span><br><span class="line">there!</span><br><span class="line">want</span><br><span class="line">to</span><br><span class="line">listen</span><br><span class="line">to</span><br><span class="line">mister</span><br><span class="line">?</span><br></pre></td></tr></table></figure>

<h3 id="compactMap"><a href="#compactMap" class="headerlink" title="compactMap()"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7017623451858894862">compactMap()</a></h3><ul>
<li>把Optional值去除，跟<a target="_blank" rel="noopener" href="https://medium.com/jeremy-xue-s-blog/swift-transforming-an-array-e2bcb4f4d67d">compactMap()</a>很像</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;compactMap&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> strings <span class="operator">=</span> [<span class="string">&quot;a&quot;</span>, <span class="string">&quot;1.24&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;def&quot;</span>, <span class="string">&quot;45&quot;</span>, <span class="string">&quot;0.23&quot;</span>].publisher</span><br><span class="line">    </span><br><span class="line">    strings</span><br><span class="line">        .compactMap &#123; <span class="type">Float</span>(<span class="variable">$0</span>) &#125;               <span class="comment">/// 過濾Float</span></span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: compactMap ===</span><br><span class="line">1.24</span><br><span class="line">3.0</span><br><span class="line">45.0</span><br><span class="line">0.23</span><br></pre></td></tr></table></figure>

<h3 id="ignoreOutput"><a href="#ignoreOutput" class="headerlink" title="ignoreOutput()"></a><a target="_blank" rel="noopener" href="https://www.kodeco.com/books/combine-asynchronous-programming-with-swift/v3.0/chapters/4-filtering-operators">ignoreOutput()</a></h3><ul>
<li>取得的值不重要，只關心<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/341961251">完成</a>了沒有</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;ignoreOutput&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> numbers <span class="operator">=</span> (<span class="number">1</span><span class="operator">...</span><span class="number">10_000</span>).publisher</span><br><span class="line"></span><br><span class="line">    numbers</span><br><span class="line">        .ignoreOutput()</span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="built_in">print</span>(<span class="string">&quot;完成: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: ignoreOutput ===</span><br><span class="line">完成: finished</span><br></pre></td></tr></table></figure>

<h3 id="first-where"><a href="#first-where" class="headerlink" title="first(where:)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7017623451858894862">first(where:)</a></h3><ul>
<li>取得第一個符合過濾的值</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;first(where:)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> multiple <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">let</span> numbers <span class="operator">=</span> (<span class="number">1</span><span class="operator">...</span><span class="number">9</span>).publisher</span><br><span class="line">    </span><br><span class="line">    numbers</span><br><span class="line">        .print(<span class="string">&quot;numbers&quot;</span>)</span><br><span class="line">        .first(where: &#123; <span class="variable">$0</span> <span class="operator">%</span> multiple <span class="operator">==</span> <span class="number">0</span> &#125;)</span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="built_in">print</span>(<span class="string">&quot;完成: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;第一個偶數: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: first(<span class="built_in">where</span>:) ===</span><br><span class="line">numbers: receive subscription: (1...9)</span><br><span class="line">numbers: request unlimited</span><br><span class="line">numbers: receive value: (1)</span><br><span class="line">numbers: receive value: (2)</span><br><span class="line">numbers: receive cancel</span><br><span class="line">第一個偶數: 2</span><br><span class="line">完成: finished</span><br></pre></td></tr></table></figure>

<h3 id="last-where"><a href="#last-where" class="headerlink" title="last(where:)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7017623451858894862">last(where:)</a></h3><ul>
<li>取得最後一個符合過濾的值</li>
<li>取得第一個很簡單，只要有符合就行了；但是最後一個的話，就要finished才可以</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;last(where:)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> numbers <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    numbers</span><br><span class="line">        .last(where: &#123; <span class="variable">$0</span> <span class="operator">%</span> <span class="number">2</span> <span class="operator">==</span> <span class="number">0</span> &#125;)</span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="built_in">print</span>(<span class="string">&quot;完成: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;最後一個偶數: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    numbers.send(<span class="number">1</span>)</span><br><span class="line">    numbers.send(<span class="number">2</span>)</span><br><span class="line">    numbers.send(<span class="number">3</span>)</span><br><span class="line">    numbers.send(<span class="number">4</span>)</span><br><span class="line">    numbers.send(<span class="number">5</span>)</span><br><span class="line">    numbers.send(completion: .finished)		<span class="comment">/// 要執行這個後才有值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: last(<span class="built_in">where</span>:) ===</span><br><span class="line">最後一個偶數: 4</span><br><span class="line">完成: finished</span><br></pre></td></tr></table></figure>

<h3 id="dropFirst"><a href="#dropFirst" class="headerlink" title="dropFirst()"></a><a target="_blank" rel="noopener" href="https://www.kodeco.com/books/combine-asynchronous-programming-with-swift/v3.0/chapters/4-filtering-operators">dropFirst()</a></h3><ul>
<li>忽略掉前面的值</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;dropFirst&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> numbers <span class="operator">=</span> (<span class="number">1</span><span class="operator">...</span><span class="number">10</span>).publisher</span><br><span class="line">    </span><br><span class="line">    numbers</span><br><span class="line">        .dropFirst(<span class="number">8</span>)       <span class="comment">/// 忽略掉前8組</span></span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: dropFirst ===</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td></tr></table></figure>

<h3 id="drop-while"><a href="#drop-while" class="headerlink" title="drop(while:)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7017853525271150599">drop(while:)</a></h3><ul>
<li>有條件的忽略掉數值</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;drop(while:)&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> numbers <span class="operator">=</span> (<span class="number">1</span><span class="operator">...</span><span class="number">10</span>).publisher</span><br><span class="line"></span><br><span class="line">    numbers</span><br><span class="line">        .drop(while: &#123; <span class="built_in">print</span>(<span class="string">&quot;x&quot;</span>); <span class="keyword">return</span> <span class="variable">$0</span> <span class="operator">%</span> <span class="number">5</span> <span class="operator">!=</span> <span class="number">0</span>&#125;)</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: dropFirst ===</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td></tr></table></figure>

<h3 id="drop-while-1"><a href="#drop-while-1" class="headerlink" title="drop(while:)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7017853525271150599">drop(while:)</a></h3><ul>
<li>有條件的忽略掉數值</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;drop(untilOutputFrom:)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> isReady <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Void</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> taps <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    taps.drop(untilOutputFrom: isReady)         <span class="comment">/// 直到isReady變數發出值之後才動作</span></span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    (<span class="number">1</span><span class="operator">...</span><span class="number">5</span>).forEach &#123; n <span class="keyword">in</span></span><br><span class="line">        taps.send(n)                            <span class="comment">/// 在isReady發出值之前都是沒有用的</span></span><br><span class="line">        <span class="keyword">if</span> n <span class="operator">==</span> <span class="number">3</span> &#123; isReady.send() &#125;            <span class="comment">/// isReady發出值</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: drop(untilOutputFrom:) ===</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td></tr></table></figure>

<h3 id="prefix-while"><a href="#prefix-while" class="headerlink" title="prefix(while:)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7017853525271150599">prefix(while:)</a></h3><ul>
<li>跟drop(while:)相反的功能，只取前面幾組，後面的不重要</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;prefix(while:)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> numbers <span class="operator">=</span> (<span class="number">1</span><span class="operator">...</span><span class="number">10</span>).publisher</span><br><span class="line">    </span><br><span class="line">    numbers</span><br><span class="line">        .prefix(while: &#123; <span class="variable">$0</span> <span class="operator">&lt;</span> <span class="number">3</span> &#125;)</span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="built_in">print</span>(<span class="string">&quot;完成: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: prefix(<span class="keyword">while</span>:) ===</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">完成: finished</span><br></pre></td></tr></table></figure>

<h3 id="prefix-while-1"><a href="#prefix-while-1" class="headerlink" title="prefix(while:)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7017853525271150599">prefix(while:)</a></h3><ul>
<li>跟drop(while:)相反的功能，只取前面幾組，後面的不重要</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;prefix(while:)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> numbers <span class="operator">=</span> (<span class="number">1</span><span class="operator">...</span><span class="number">10</span>).publisher</span><br><span class="line">    </span><br><span class="line">    numbers</span><br><span class="line">        .prefix(while: &#123; <span class="variable">$0</span> <span class="operator">&lt;</span> <span class="number">3</span> &#125;)</span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="built_in">print</span>(<span class="string">&quot;完成: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: prefix(<span class="keyword">while</span>:) ===</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">完成: finished</span><br></pre></td></tr></table></figure>

<h3 id="prefix-untilOutputFrom"><a href="#prefix-untilOutputFrom" class="headerlink" title="prefix(untilOutputFrom:)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7017853525271150599">prefix(untilOutputFrom:)</a></h3><ul>
<li>跟drop(untilOutputFrom:)相反的功能，只取前面幾組，後面的不重要</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;prefix(untilOutputFrom:)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> isReady <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Void</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> taps <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    taps</span><br><span class="line">        .prefix(untilOutputFrom: isReady)                   <span class="comment">/// 直到isReady變數發出值之後不停止</span></span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="built_in">print</span>(<span class="string">&quot;完成: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    (<span class="number">1</span><span class="operator">...</span><span class="number">5</span>).forEach &#123; n <span class="keyword">in</span></span><br><span class="line">        taps.send(n)                                        <span class="comment">/// 在isReady發出值之前一直是有效的</span></span><br><span class="line">        <span class="keyword">if</span> n <span class="operator">==</span> <span class="number">2</span> &#123; isReady.send() &#125;                        <span class="comment">/// isReady發出值</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: prefix(untilOutputFrom:) ===</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">完成: finished</span><br></pre></td></tr></table></figure>

<h2 id="Lesson-04-結合用的Operator"><a href="#Lesson-04-結合用的Operator" class="headerlink" title="Lesson.04 - 結合用的Operator"></a>Lesson.04 - 結合用的Operator</h2><h3 id="prepend-Output…"><a href="#prepend-Output…" class="headerlink" title="prepend(Output…)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7018447582229692452">prepend(Output…)</a></h3><ul>
<li>在原本的publisher之前加入數值，可以應用在一些一定要出現的介紹詞之上…</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;prepend(Output...)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="string">&quot;新會員&quot;</span>, <span class="string">&quot;William&quot;</span>].publisher</span><br><span class="line">    </span><br><span class="line">    publisher</span><br><span class="line">        .prepend(<span class="string">&quot;歡迎來到『人生40才開始』&quot;</span>, <span class="string">&quot;別忘了繳入會費喲&quot;</span>)   <span class="comment">// 再在前面加上 [&quot;歡迎來到『人生40才開始』&quot;, &quot;別忘了繳入會費喲&quot;]</span></span><br><span class="line">        .prepend(<span class="string">&quot;嗨!!!&quot;</span>, <span class="string">&quot;您好&quot;</span>)                            <span class="comment">// 先在前面加上 [&quot;嗨!!!&quot;, &quot;您好&quot;]  =&gt; [&quot;嗨!!!&quot;, &quot;您好&quot;, &quot;歡迎來到『人生40才開始』&quot;, &quot;別忘了繳入會費喲&quot;]</span></span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: prepend(Output...) ===</span><br><span class="line">嗨!!!</span><br><span class="line">您好</span><br><span class="line">歡迎來到『人生40才開始』</span><br><span class="line">別忘了繳入會費喲</span><br><span class="line">新會員</span><br><span class="line">William</span><br></pre></td></tr></table></figure>

<h3 id="prepend-Sequence"><a href="#prepend-Sequence" class="headerlink" title="prepend(Sequence)"></a><a href="">prepend(Sequence)</a></h3><ul>
<li>遵循<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swift/sequence">Sequence Protocol</a>的都可以使用</li>
<li>也就是有順序關係的，像：<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swift/array">Array</a> &#x2F; <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swift/set">Set</a> &#x2F; <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swift/stride(from:to:by:&#41;">Stride</a></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;prepend(Sequence)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>].publisher</span><br><span class="line">    <span class="keyword">let</span> array <span class="operator">=</span> [<span class="number">3</span>, <span class="number">4</span>]                              <span class="comment">// Array也可以</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">set</span> <span class="operator">=</span> <span class="type">Set</span>(<span class="number">1</span><span class="operator">...</span><span class="number">2</span>)                            <span class="comment">// Set也可以</span></span><br><span class="line">    <span class="keyword">let</span> stride <span class="operator">=</span> <span class="built_in">stride</span>(from: <span class="number">6</span>, to: <span class="number">11</span>, by: <span class="number">2</span>)     <span class="comment">// Stride也可以</span></span><br><span class="line">    </span><br><span class="line">    publisher</span><br><span class="line">        .prepend(array)</span><br><span class="line">        .prepend(<span class="keyword">set</span>)</span><br><span class="line">        .prepend(stride)</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: prepend(Sequence) ===</span><br><span class="line">6</span><br><span class="line">8</span><br><span class="line">10</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td></tr></table></figure>

<h3 id="prepend-Publisher"><a href="#prepend-Publisher" class="headerlink" title="prepend(Publisher)"></a><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/combine/publisher/prepend(_:%#41;-v9sb">prepend(Publisher)</a></h3><ul>
<li>publisher當參數也可以</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;prepend(Publisher)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher1 <span class="operator">=</span> [<span class="number">3</span>, <span class="number">4</span>].publisher</span><br><span class="line">    <span class="keyword">let</span> publisher2 <span class="operator">=</span> [<span class="number">1</span>, <span class="number">2</span>].publisher</span><br><span class="line">    </span><br><span class="line">    publisher1</span><br><span class="line">        .prepend(publisher2)</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: prepend(Publisher) ===</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<ul>
<li>這樣也行</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;prepend(Publisher) #2&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher1 <span class="operator">=</span> [<span class="number">3</span>, <span class="number">4</span>].publisher</span><br><span class="line">    <span class="keyword">let</span> publisher2 <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    publisher1</span><br><span class="line">        .prepend(publisher2)</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    publisher2.send(<span class="number">1</span>)</span><br><span class="line">    publisher2.send(<span class="number">2</span>)</span><br><span class="line">    publisher2.send(completion: .finished)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: prepend(Publisher) <span class="comment">#2 ===</span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<h3 id="append-Output…"><a href="#append-Output…" class="headerlink" title="append(Output…)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7018447582229692452">append(Output…)</a></h3><ul>
<li>append正好跟prepend相反，它是加在後面的功能…</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;append(Output...)&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="string">&quot;您好&quot;</span>, <span class="string">&quot;我是William&quot;</span>].publisher</span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .append(<span class="string">&quot;-演出人員名單-&quot;</span>, <span class="string">&quot;-配樂清單-&quot;</span>)</span><br><span class="line">        .append(<span class="string">&quot;~終~&quot;</span>)</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: append(Output...) ===</span><br><span class="line">您好</span><br><span class="line">我是William</span><br><span class="line">-演出人員名單-</span><br><span class="line">-配樂清單-</span><br><span class="line">~終~</span><br></pre></td></tr></table></figure>

<ul>
<li>這樣也可以</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;append(Output...) #2&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    publisher</span><br><span class="line">        .append(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">        .append(<span class="number">5</span>)</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    publisher.send(<span class="number">1</span>)</span><br><span class="line">    publisher.send(<span class="number">2</span>)</span><br><span class="line">    publisher.send(completion: .finished)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: append(Output...) <span class="comment">#2 ===</span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td></tr></table></figure>

<h3 id="append-Sequence"><a href="#append-Sequence" class="headerlink" title="append(Sequence)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7018447582229692452">append(Sequence)</a></h3><ul>
<li>跟append(Sequence)相反，就不多做介紹了</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;append(Sequence)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].publisher</span><br><span class="line">    </span><br><span class="line">    publisher</span><br><span class="line">        .append([<span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line">        .append(<span class="type">Set</span>([<span class="number">6</span>, <span class="number">7</span>]))</span><br><span class="line">        .append(<span class="built_in">stride</span>(from: <span class="number">8</span>, to: <span class="number">11</span>, by: <span class="number">2</span>))</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: append(Sequence) ===</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">7</span><br><span class="line">6</span><br><span class="line">8</span><br><span class="line">10</span><br></pre></td></tr></table></figure>

<h3 id="append-Publisher"><a href="#append-Publisher" class="headerlink" title="append(Publisher)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7018447582229692452">append(Publisher)</a></h3><ul>
<li>跟append(Publisher)相反，也不多做介紹了</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;append(Publisher)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher1 <span class="operator">=</span> [<span class="number">1</span>, <span class="number">2</span>].publisher</span><br><span class="line">    <span class="keyword">let</span> publisher2 <span class="operator">=</span> [<span class="number">3</span>, <span class="number">4</span>].publisher</span><br><span class="line">    </span><br><span class="line">    publisher1</span><br><span class="line">        .append(publisher2)</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: append(Publisher) ===</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<h3 id="switchToLatest"><a href="#switchToLatest" class="headerlink" title="switchToLatest"></a><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/345054834">switchToLatest</a></h3><ul>
<li>切換到最後一個Publisher</li>
<li>在應用上的話，就像及時搜尋單字框，會一直送request，但是我們只需要最後一次的單字就好，中間的不要動作，減少多餘的request發送</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;switchToLatest&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher1 <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> publisher2 <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> publisher3 <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> publishers <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    publishers</span><br><span class="line">        .switchToLatest()</span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="keyword">_</span> <span class="keyword">in</span> <span class="built_in">print</span>(<span class="string">&quot;Completed!&quot;</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    publishers.send(publisher1)</span><br><span class="line">    publisher1.send(<span class="number">1</span>)</span><br><span class="line">    publisher1.send(<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    publishers.send(publisher2)</span><br><span class="line">    publisher1.send(<span class="number">3</span>)</span><br><span class="line">    publisher2.send(<span class="number">4</span>)</span><br><span class="line">    publisher2.send(<span class="number">5</span>)</span><br><span class="line">    </span><br><span class="line">    publishers.send(publisher3)</span><br><span class="line">    publisher2.send(<span class="number">6</span>)</span><br><span class="line">    publisher3.send(<span class="number">7</span>)</span><br><span class="line">    publisher3.send(<span class="number">8</span>)</span><br><span class="line">    publisher3.send(<span class="number">9</span>)</span><br><span class="line">    </span><br><span class="line">    publisher3.send(completion: .finished)</span><br><span class="line">    publishers.send(completion: .finished)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: switchToLatest ===</span><br><span class="line">publisher1 - 1</span><br><span class="line">publisher1 - 2</span><br><span class="line">publisher2 - 4</span><br><span class="line">publisher2 - 5</span><br><span class="line">publisher3 - 7</span><br><span class="line">publisher3 - 8</span><br><span class="line">publisher3 - 9</span><br><span class="line">Completed!</span><br></pre></td></tr></table></figure>

<ul>
<li>實際應用<br><img src="/../../source/images/Study_Combine/SwitchToLatest.png"></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;switchToLatest - Network Request&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> url <span class="operator">=</span> <span class="type">URL</span>(string: <span class="string">&quot;https://picsum.photos/128&quot;</span>)<span class="operator">!</span></span><br><span class="line">    <span class="keyword">let</span> taps <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Void</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    taps.map &#123; <span class="keyword">_</span> <span class="keyword">in</span> getImage() &#125;</span><br><span class="line">        .switchToLatest()</span><br><span class="line">        .sink(receiveValue: &#123; <span class="keyword">_</span> <span class="keyword">in</span> &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    taps.send()                                                                            <span class="comment">// 下載圖片動作</span></span><br><span class="line">    <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: .now() <span class="operator">+</span> <span class="number">3.0</span>) &#123; <span class="built_in">print</span>(<span class="type">Date</span>()); taps.send() &#125;</span><br><span class="line">    <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: .now() <span class="operator">+</span> <span class="number">3.1</span>) &#123; <span class="built_in">print</span>(<span class="type">Date</span>()); taps.send() &#125;</span><br><span class="line">    <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: .now() <span class="operator">+</span> <span class="number">3.2</span>) &#123; <span class="built_in">print</span>(<span class="type">Date</span>()); taps.send() &#125;</span><br><span class="line">    <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: .now() <span class="operator">+</span> <span class="number">3.3</span>) &#123; <span class="built_in">print</span>(<span class="type">Date</span>()); taps.send() &#125;</span><br><span class="line">    <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: .now() <span class="operator">+</span> <span class="number">3.4</span>) &#123; <span class="built_in">print</span>(<span class="type">Date</span>()); taps.send() &#125;   <span class="comment">// 只會留這一個下載圖片動作</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">getImage</span>() -&gt; <span class="type">AnyPublisher</span>&lt;<span class="type">UIImage</span>?, <span class="type">Never</span>&gt; &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">URLSession</span>.shared</span><br><span class="line">            .dataTaskPublisher(for: url)</span><br><span class="line">            .map &#123; data, <span class="keyword">_</span> <span class="keyword">in</span> <span class="type">UIImage</span>(data: data) &#125;</span><br><span class="line">            .print(<span class="string">&quot;[image]&quot;</span>)</span><br><span class="line">            .replaceError(with: <span class="literal">nil</span>)</span><br><span class="line">            .eraseToAnyPublisher()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: switchToLatest - Network Request ===</span><br><span class="line">[image]: receive subscription: (DataTaskPublisher)</span><br><span class="line">[image]: request unlimited</span><br><span class="line">[image]: receive value: (Optional(&lt;UIImage:0x600001eec480 anonymous &#123;128, 128&#125; renderingMode=automatic(original)&gt;))</span><br><span class="line">[image]: receive finished</span><br><span class="line">2023-05-30 07:02:02 +0000</span><br><span class="line">[image]: receive subscription: (DataTaskPublisher)</span><br><span class="line">[image]: request unlimited</span><br><span class="line">2023-05-30 07:02:02 +0000</span><br><span class="line">[image]: receive cancel</span><br><span class="line">[image]: receive subscription: (DataTaskPublisher)</span><br><span class="line">[image]: request unlimited</span><br><span class="line">2023-05-30 07:02:02 +0000</span><br><span class="line">[image]: receive cancel</span><br><span class="line">[image]: receive subscription: (DataTaskPublisher)</span><br><span class="line">[image]: request unlimited</span><br><span class="line">2023-05-30 07:02:02 +0000</span><br><span class="line">[image]: receive cancel</span><br><span class="line">[image]: receive subscription: (DataTaskPublisher)</span><br><span class="line">[image]: request unlimited</span><br><span class="line">2023-05-30 07:02:02 +0000</span><br><span class="line">[image]: receive cancel</span><br><span class="line">[image]: receive subscription: (DataTaskPublisher)</span><br><span class="line">[image]: request unlimited</span><br><span class="line">[image]: receive value: (Optional(&lt;UIImage:0x600001eec5a0 anonymous &#123;128, 128&#125; renderingMode=automatic(original)&gt;))</span><br><span class="line">[image]: receive finished</span><br></pre></td></tr></table></figure>

<h3 id="merge-with"><a href="#merge-with" class="headerlink" title="merge(with:)"></a><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10221533">merge(with:)</a></h3><ul>
<li>把Publisher們合併在一起</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;merge(with:)&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher1 <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> publisher2 <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    publisher1</span><br><span class="line">        .merge(with: publisher2)</span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="keyword">_</span> <span class="keyword">in</span> <span class="built_in">print</span>(<span class="string">&quot;Completed&quot;</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    publisher1.send(<span class="number">1</span>)</span><br><span class="line">    publisher1.send(<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    publisher2.send(<span class="number">3</span>)</span><br><span class="line">    </span><br><span class="line">    publisher1.send(<span class="number">4</span>)</span><br><span class="line">    </span><br><span class="line">    publisher2.send(<span class="number">5</span>)</span><br><span class="line">    </span><br><span class="line">    publisher1.send(completion: .finished)</span><br><span class="line">    publisher2.send(completion: .finished)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: merge(with:) ===</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>

<h3 id="combineLatest"><a href="#combineLatest" class="headerlink" title="combineLatest()"></a><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10221533">combineLatest()</a></h3><ul>
<li>合併最後的一個publisher</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;combineLatest&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher1 <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> publisher2 <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">String</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    publisher1</span><br><span class="line">        .combineLatest(publisher2)</span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="keyword">_</span> <span class="keyword">in</span> <span class="built_in">print</span>(<span class="string">&quot;Completed&quot;</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;(<span class="subst">\(<span class="variable">$0</span>)</span>, <span class="subst">\(<span class="variable">$1</span>)</span>)&quot;</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    publisher1.send(<span class="number">1</span>)</span><br><span class="line">    publisher2.send(<span class="string">&quot;a&quot;</span>)</span><br><span class="line"></span><br><span class="line">    publisher1.send(<span class="number">2</span>)</span><br><span class="line">    publisher2.send(<span class="string">&quot;b&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    publisher1.send(<span class="number">3</span>)</span><br><span class="line">    publisher2.send(<span class="string">&quot;c&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    publisher1.send(completion: .finished)</span><br><span class="line">    publisher2.send(completion: .finished)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: combineLatest ===</span><br><span class="line">(1, a)</span><br><span class="line">(2, a)</span><br><span class="line">(2, b)</span><br><span class="line">(3, b)</span><br><span class="line">(3, c)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>

<h3 id="zip"><a href="#zip" class="headerlink" title="zip()"></a><a target="_blank" rel="noopener" href="https://augmentedcode.io/2022/10/03/combine-publishers-merge-zip-and-combinelatest-on-ios/">zip()</a></h3><ul>
<li>這個跟combineLatest不太一樣，它是一對一合併</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;zip&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher1 <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> publisher2 <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">String</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    publisher1</span><br><span class="line">        .zip(publisher2)</span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="keyword">_</span> <span class="keyword">in</span> <span class="built_in">print</span>(<span class="string">&quot;Completed&quot;</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;(<span class="subst">\(<span class="variable">$0</span>)</span> ,<span class="subst">\(<span class="variable">$1</span>)</span>)&quot;</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    publisher1.send(<span class="number">1</span>)</span><br><span class="line">    publisher1.send(<span class="number">2</span>)</span><br><span class="line">    publisher2.send(<span class="string">&quot;a&quot;</span>)</span><br><span class="line">    publisher2.send(<span class="string">&quot;b&quot;</span>)</span><br><span class="line">    publisher1.send(<span class="number">3</span>)</span><br><span class="line">    publisher2.send(<span class="string">&quot;c&quot;</span>)</span><br><span class="line">    publisher2.send(<span class="string">&quot;d&quot;</span>)</span><br><span class="line">    publisher1.send(<span class="number">4</span>)</span><br><span class="line">    publisher2.send(<span class="string">&quot;e&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    publisher1.send(completion: .finished)</span><br><span class="line">    publisher2.send(completion: .finished)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: zip ===</span><br><span class="line">(1 ,a)</span><br><span class="line">(2 ,b)</span><br><span class="line">(3 ,c)</span><br><span class="line">(4 ,d)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>

<h2 id="Lesson-05-時間操作運算子"><a href="#Lesson-05-時間操作運算子" class="headerlink" title="Lesson.05 - 時間操作運算子"></a>Lesson.05 - 時間操作運算子</h2><h3 id="delay-for-tolerance-scheduler-options"><a href="#delay-for-tolerance-scheduler-options" class="headerlink" title="delay(for:tolerance:scheduler:options)"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7020305767324450823">delay(for:tolerance:scheduler:options)</a></h3><ul>
<li>可以延遲來自發佈者的值，以便您看到它們比它們實際發生的時間晚…</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> delaySeccond <span class="operator">=</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">let</span> timerSeccond <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> subscriptions <span class="operator">=</span> <span class="type">Set</span>&lt;<span class="type">AnyCancellable</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> timerPublisher <span class="operator">=</span> <span class="type">Timer</span></span><br><span class="line">  .publish(every: <span class="type">Double</span>(timerSeccond) , on: .main, in: .common)</span><br><span class="line">  .autoconnect()</span><br><span class="line"></span><br><span class="line">timerPublisher</span><br><span class="line">    .handleEvents(receiveOutput: &#123; date <span class="keyword">in</span> print (<span class="string">&quot;每<span class="subst">\(timerSeccond)</span>秒發送訊息<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\(date)</span>&quot;</span>) &#125;)</span><br><span class="line">    .delay(for: .seconds(delaySeccond), scheduler: <span class="type">DispatchQueue</span>.main)</span><br><span class="line">    .sink &#123; value <span class="keyword">in</span> <span class="built_in">print</span>(<span class="string">&quot;收到前<span class="subst">\(delaySeccond)</span>秒的訊息<span class="subst">\t</span><span class="subst">\(value)</span>&quot;</span>) &#125;</span><br><span class="line">    .store(in: <span class="operator">&amp;</span>subscriptions)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">每1秒發送訊息		2023-06-14 05:35:30 +0000</span><br><span class="line">每1秒發送訊息		2023-06-14 05:35:31 +0000</span><br><span class="line">每1秒發送訊息		2023-06-14 05:35:32 +0000</span><br><span class="line">收到前2秒的訊息	2023-06-14 05:35:30 +0000</span><br><span class="line">每1秒發送訊息		2023-06-14 05:35:33 +0000</span><br><span class="line">收到前2秒的訊息	2023-06-14 05:35:31 +0000</span><br><span class="line">每1秒發送訊息		2023-06-14 05:35:34 +0000</span><br><span class="line">收到前2秒的訊息	2023-06-14 05:35:32 +0000</span><br></pre></td></tr></table></figure>

<ul>
<li>圖文版加強版<br><img src="/../../source/images/Study_Combine/Delay.png"></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> valuesPerSecond <span class="operator">=</span> <span class="number">1.0</span></span><br><span class="line"><span class="keyword">let</span> delayInSeconds <span class="operator">=</span> <span class="number">1.5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sourcePublisher <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Date</span>, <span class="type">Never</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> delayedPublisher <span class="operator">=</span> sourcePublisher.delay(for: .seconds(delayInSeconds), scheduler: <span class="type">DispatchQueue</span>.main)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subscription <span class="operator">=</span> <span class="type">Timer</span></span><br><span class="line">    .publish(every: <span class="number">1.0</span> <span class="operator">/</span> valuesPerSecond, on: .main, in: .common)</span><br><span class="line">    .autoconnect()</span><br><span class="line">    .subscribe(sourcePublisher)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sourceTimeline <span class="operator">=</span> <span class="type">TimelineView</span>(title: <span class="string">&quot;發射數值 - <span class="subst">\(valuesPerSecond)</span> 個/秒&quot;</span>)</span><br><span class="line"><span class="keyword">let</span> delayedTimeline <span class="operator">=</span> <span class="type">TimelineView</span>(title: <span class="string">&quot;發射數值 - 延遲<span class="subst">\(delayInSeconds)</span>秒&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> view <span class="operator">=</span> <span class="type">VStack</span>(spacing: <span class="number">50</span>) &#123;</span><br><span class="line">    sourceTimeline</span><br><span class="line">    delayedTimeline</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sourcePublisher.displayEvents(in: sourceTimeline)</span><br><span class="line">delayedPublisher.displayEvents(in: delayedTimeline)</span><br><span class="line"></span><br><span class="line"><span class="type">PlaygroundPage</span>.current.liveView <span class="operator">=</span> <span class="type">UIHostingController</span>(rootView: view.frame(width: <span class="number">800</span>, height: <span class="number">600</span>))</span><br></pre></td></tr></table></figure>

<h3 id="collect-1"><a href="#collect-1" class="headerlink" title="collect()"></a><a target="_blank" rel="noopener" href="https://jllnmercier.medium.com/combine-collect-operator-cf818f119806">collect()</a></h3><ul>
<li>定時收集數值…</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> subscriber <span class="operator">=</span> <span class="type">Timer</span>.publish(every: <span class="number">0.5</span>, on: .main, in: .default) <span class="comment">// 每0.5秒發一次</span></span><br><span class="line">    .autoconnect()</span><br><span class="line">    .collect(.byTime(<span class="type">RunLoop</span>.main, .seconds(<span class="number">3</span>)))                    <span class="comment">// 收集3秒內的數值 =&gt; 3 / 0.5 = 6個數值</span></span><br><span class="line">    .sink &#123; <span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>, terminator: <span class="string">&quot;<span class="subst">\n</span><span class="subst">\n</span>&quot;</span>) &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[2023-06-14 05:44:25 +0000, 2023-06-14 05:44:25 +0000, 2023-06-14 05:44:26 +0000, 2023-06-14 05:44:26 +0000, 2023-06-14 05:44:27 +0000]</span><br><span class="line"></span><br><span class="line">[2023-06-14 05:44:27 +0000, 2023-06-14 05:44:28 +0000, 2023-06-14 05:44:28 +0000, 2023-06-14 05:44:29 +0000, 2023-06-14 05:44:29 +0000, 2023-06-14 05:44:30 +0000]</span><br><span class="line"></span><br><span class="line">[2023-06-14 05:44:30 +0000, 2023-06-14 05:44:31 +0000, 2023-06-14 05:44:31 +0000, 2023-06-14 05:44:32 +0000, 2023-06-14 05:44:32 +0000, 2023-06-14 05:44:33 +0000]</span><br></pre></td></tr></table></figure>

<ul>
<li>圖文版加強版<br><img src="/../../source/images/Study_Combine/Collect.png"></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> valuesPerSecond <span class="operator">=</span> <span class="number">1.0</span></span><br><span class="line"><span class="keyword">let</span> collectTimeStride <span class="operator">=</span> <span class="number">4</span></span><br><span class="line"><span class="keyword">let</span> collectMaxCount <span class="operator">=</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sourcePublisher <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Date</span>, <span class="type">Never</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> collectedPublisher <span class="operator">=</span> sourcePublisher</span><br><span class="line">  .collect(.byTime(<span class="type">DispatchQueue</span>.main, .seconds(collectTimeStride)))</span><br><span class="line">  .flatMap &#123; dates <span class="keyword">in</span> dates.publisher &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> collectedPublisher2 <span class="operator">=</span> sourcePublisher</span><br><span class="line">  .collect(.byTimeOrCount(<span class="type">DispatchQueue</span>.main, .seconds(collectTimeStride), collectMaxCount))</span><br><span class="line">  .flatMap &#123; dates <span class="keyword">in</span> dates.publisher &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subscription <span class="operator">=</span> <span class="type">Timer</span></span><br><span class="line">  .publish(every: <span class="number">1.0</span> <span class="operator">/</span> valuesPerSecond, on: .main, in: .common)</span><br><span class="line">  .autoconnect()</span><br><span class="line">  .subscribe(sourcePublisher)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sourceTimeline <span class="operator">=</span> <span class="type">TimelineView</span>(title: <span class="string">&quot;Emitted values:&quot;</span>)</span><br><span class="line"><span class="keyword">let</span> collectedTimeline <span class="operator">=</span> <span class="type">TimelineView</span>(title: <span class="string">&quot;Collected values (every <span class="subst">\(collectTimeStride)</span>s):&quot;</span>)</span><br><span class="line"><span class="keyword">let</span> collectedTimeline2 <span class="operator">=</span> <span class="type">TimelineView</span>(title: <span class="string">&quot;Collected values (at most <span class="subst">\(collectMaxCount)</span> every <span class="subst">\(collectTimeStride)</span>s):&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> view <span class="operator">=</span> <span class="type">VStack</span>(spacing: <span class="number">40</span>) &#123;</span><br><span class="line">  sourceTimeline</span><br><span class="line">  collectedTimeline</span><br><span class="line">  collectedTimeline2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">PlaygroundPage</span>.current.liveView <span class="operator">=</span> <span class="type">UIHostingController</span>(rootView: view.frame(width: <span class="number">600</span>, height: <span class="number">600</span>))</span><br><span class="line"></span><br><span class="line">sourcePublisher.displayEvents(in: sourceTimeline)</span><br><span class="line">collectedPublisher.displayEvents(in: collectedTimeline)</span><br><span class="line">collectedPublisher2.displayEvents(in: collectedTimeline2)</span><br></pre></td></tr></table></figure>

<h3 id="debounce"><a href="#debounce" class="headerlink" title="debounce()"></a><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10222968">debounce()</a></h3><ul>
<li>取時間內的最後一個數值</li>
<li>比如在短時間內Button連點的問題，只處理最後一次點選事件</li>
<li>也就是除了Delay，還會過濾</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bounces:[(<span class="type">Int</span>, <span class="type">TimeInterval</span>)] <span class="operator">=</span> [</span><br><span class="line">    (<span class="number">1</span>, <span class="number">0.1</span>),   <span class="comment">// 0.1秒 =&gt; 1</span></span><br><span class="line">    (<span class="number">2</span>, <span class="number">0.2</span>),   <span class="comment">// 0.2秒 =&gt; 2</span></span><br><span class="line">    (<span class="number">5</span>, <span class="number">1.1</span>),   <span class="comment">// 1.1秒 =&gt; 5</span></span><br><span class="line">    (<span class="number">6</span>, <span class="number">1.2</span>)    <span class="comment">// 1.2秒 =&gt; 6</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cancellable <span class="operator">=</span> subject</span><br><span class="line">    .debounce(for: .seconds(<span class="number">0.5</span>), scheduler: <span class="type">RunLoop</span>.main)</span><br><span class="line">    .sink &#123; index <span class="keyword">in</span> print (<span class="string">&quot;Received index <span class="subst">\(index)</span>&quot;</span>) &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> bounce <span class="keyword">in</span> bounces &#123;</span><br><span class="line">    <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: .now() <span class="operator">+</span> bounce.<span class="number">1</span>) &#123;</span><br><span class="line">        subject.send(bounce.<span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>圖文版加強版<br><img src="/../../source/images/Study_Combine/Debounce.png"></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">String</span>, <span class="type">Never</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> debounced <span class="operator">=</span> subject</span><br><span class="line">  .debounce(for: .seconds(<span class="number">1.0</span>), scheduler: <span class="type">DispatchQueue</span>.main)</span><br><span class="line">  .share()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subjectTimeline <span class="operator">=</span> <span class="type">TimelineView</span>(title: <span class="string">&quot;Emitted values&quot;</span>)</span><br><span class="line"><span class="keyword">let</span> debouncedTimeline <span class="operator">=</span> <span class="type">TimelineView</span>(title: <span class="string">&quot;Debounced values&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> view <span class="operator">=</span> <span class="type">VStack</span>(spacing: <span class="number">100</span>) &#123;</span><br><span class="line">  subjectTimeline</span><br><span class="line">  debouncedTimeline</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">subject.displayEvents(in: subjectTimeline)</span><br><span class="line">debounced.displayEvents(in: debouncedTimeline)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subscription1 <span class="operator">=</span> subject</span><br><span class="line">  .sink &#123; string <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;+<span class="subst">\(deltaTime)</span>s: Subject emitted: <span class="subst">\(string)</span>&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subscription2 <span class="operator">=</span> debounced</span><br><span class="line">  .sink &#123; string <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;+<span class="subst">\(deltaTime)</span>s: Debounced emitted: <span class="subst">\(string)</span>&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">subject.feed(with: typingHelloWorld)</span><br><span class="line"></span><br><span class="line"><span class="type">PlaygroundPage</span>.current.liveView <span class="operator">=</span> <span class="type">UIHostingController</span>(rootView: view.frame(width: <span class="number">600</span>, height: <span class="number">600</span>))</span><br></pre></td></tr></table></figure>

<h3 id="throttle-for-scheduler-latest"><a href="#throttle-for-scheduler-latest" class="headerlink" title="throttle(for:scheduler:latest:)"></a><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/343631974">throttle(for:scheduler:latest:)</a></h3><ul>
<li>限制數量用</li>
<li>如果在2秒內瘋狂點選按鈕，時間窗口的時長為0.5秒，那麼throttle可以傳送4次資料</li>
<li>而debounce不會傳送資料，只有當我停止點選0.5秒後，才會傳送一次資料。</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> cancellable <span class="operator">=</span> <span class="type">Timer</span>.publish(every: <span class="number">3.0</span>, on: .main, in: .default)    <span class="comment">// 每3秒發送一次</span></span><br><span class="line">    .autoconnect()</span><br><span class="line">    .print(<span class="string">&quot;<span class="subst">\(Date().description)</span>&quot;</span>)</span><br><span class="line">    .throttle(for: <span class="number">10.0</span>, scheduler: <span class="type">RunLoop</span>.main, latest: <span class="literal">true</span>)         <span class="comment">// 每10秒內取最後一個</span></span><br><span class="line">    .sink(</span><br><span class="line">        receiveCompletion: &#123; print (<span class="string">&quot;Completion: <span class="subst">\(<span class="variable">$0</span>)</span>.&quot;</span>) &#125;,</span><br><span class="line">        receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;Received Timestamp <span class="subst">\(<span class="variable">$0</span>)</span>.&quot;</span>) &#125;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">2023-06-14 06:42:34 +0000: request unlimited</span><br><span class="line">2023-06-14 06:42:34 +0000: receive value: (2023-06-14 06:42:37 +0000)</span><br><span class="line">Received Timestamp 2023-06-14 06:42:37 +0000.</span><br><span class="line">2023-06-14 06:42:34 +0000: receive value: (2023-06-14 06:42:40 +0000)</span><br><span class="line">2023-06-14 06:42:34 +0000: receive value: (2023-06-14 06:42:43 +0000)</span><br><span class="line">2023-06-14 06:42:34 +0000: receive value: (2023-06-14 06:42:46 +0000)</span><br><span class="line">Received Timestamp 2023-06-14 06:42:46 +0000.</span><br><span class="line">2023-06-14 06:42:34 +0000: receive value: (2023-06-14 06:42:49 +0000)</span><br><span class="line">2023-06-14 06:42:34 +0000: receive value: (2023-06-14 06:42:52 +0000)</span><br><span class="line">2023-06-14 06:42:34 +0000: receive value: (2023-06-14 06:42:55 +0000)</span><br><span class="line">Received Timestamp 2023-06-14 06:42:55 +0000.</span><br><span class="line">2023-06-14 06:42:34 +0000: receive value: (2023-06-14 06:42:58 +0000)</span><br><span class="line">2023-06-14 06:42:34 +0000: receive value: (2023-06-14 06:43:01 +0000)</span><br><span class="line">2023-06-14 06:42:34 +0000: receive value: (2023-06-14 06:43:04 +0000)</span><br><span class="line">2023-06-14 06:42:34 +0000: receive value: (2023-06-14 06:43:07 +0000)</span><br><span class="line">Received Timestamp 2023-06-14 06:43:07 +0000.</span><br></pre></td></tr></table></figure>

<ul>
<li>圖文版加強版<br><img src="/../../source/images/Study_Combine/Throttle.png"></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> throttleDelay <span class="operator">=</span> <span class="number">1.0</span></span><br><span class="line"><span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">String</span>, <span class="type">Never</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> throttled <span class="operator">=</span> subject</span><br><span class="line">    .throttle(for: .seconds(throttleDelay), scheduler: <span class="type">DispatchQueue</span>.main, latest: <span class="literal">true</span>)</span><br><span class="line">    .share()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subjectTimeline <span class="operator">=</span> <span class="type">TimelineView</span>(title: <span class="string">&quot;Emitted values&quot;</span>)</span><br><span class="line"><span class="keyword">let</span> throttledTimeline <span class="operator">=</span> <span class="type">TimelineView</span>(title: <span class="string">&quot;Throttled values&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> view <span class="operator">=</span> <span class="type">VStack</span>(spacing: <span class="number">100</span>) &#123;</span><br><span class="line">    subjectTimeline</span><br><span class="line">    throttledTimeline</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">subject.displayEvents(in: subjectTimeline)</span><br><span class="line">throttled.displayEvents(in: throttledTimeline)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subscription1 <span class="operator">=</span> subject</span><br><span class="line">    .sink &#123; string <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;+<span class="subst">\(deltaTime)</span>s: Subject emitted: <span class="subst">\(string)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subscription2 <span class="operator">=</span> throttled</span><br><span class="line">    .sink &#123; string <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;+<span class="subst">\(deltaTime)</span>s: Throttled emitted: <span class="subst">\(string)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">subject.feed(with: typingHelloWorld)</span><br><span class="line"></span><br><span class="line"><span class="type">PlaygroundPage</span>.current.liveView <span class="operator">=</span> <span class="type">UIHostingController</span>(rootView: view.frame(width: <span class="number">400</span>, height: <span class="number">600</span>))</span><br></pre></td></tr></table></figure>

<h3 id="timeout-scheduler-options-customError"><a href="#timeout-scheduler-options-customError" class="headerlink" title="timeout(_:scheduler:options:customError:)"></a><a target="_blank" rel="noopener" href="https://derrickho328.medium.com/combine-timeout-a5e89b434c72">timeout(_:scheduler:options:customError:)</a></h3><ul>
<li>用於設定pipline的超時時間</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="type">WaitTime</span> : <span class="type">Int</span> <span class="operator">=</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">let</span> <span class="type">TimeoutTime</span> : <span class="type">Int</span> <span class="operator">=</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">String</span>, <span class="type">Never</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> cancellable <span class="operator">=</span> subject</span><br><span class="line">    .timeout(.seconds(<span class="type">TimeoutTime</span>), scheduler: <span class="type">DispatchQueue</span>.main, options: <span class="literal">nil</span>, customError:<span class="literal">nil</span>)</span><br><span class="line">    .sink(</span><br><span class="line">        receiveCompletion: &#123; print (<span class="string">&quot;<span class="subst">\(Date())</span> - <span class="subst">\(TimeoutTime)</span>秒後完成: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;,</span><br><span class="line">        receiveValue: &#123; print (<span class="string">&quot;<span class="subst">\(Date())</span> - 數值: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\(Date())</span> - 開始&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="type">DispatchQueue</span>.main.asyncAfter(deadline: .now() <span class="operator">+</span> .seconds(<span class="type">WaitTime</span>), execute: &#123; subject.send(<span class="string">&quot;<span class="subst">\(Date())</span> - 等<span class="subst">\(WaitTime)</span>秒後發出&quot;</span>) &#125; )</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2023-06-14 06:55:46 +0000 - 開始</span><br><span class="line">2023-06-14 06:55:49 +0000 - 數值: 2023-06-14 06:55:49 +0000 - 等2秒後發出</span><br><span class="line">2023-06-14 06:55:54 +0000 - 完成: finished</span><br></pre></td></tr></table></figure>

<ul>
<li>圖文版加強版<br><img src="/../../source/images/Study_Combine/Timeout.png"></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">TimeoutError</span>: <span class="title class_">Error</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> timedOut</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Void</span>, <span class="type">TimeoutError</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> timedOutSubject <span class="operator">=</span> subject.timeout(.seconds(<span class="number">5</span>), scheduler: <span class="type">DispatchQueue</span>.main, customError: &#123; .timedOut &#125;)</span><br><span class="line"><span class="keyword">let</span> timeline <span class="operator">=</span> <span class="type">TimelineView</span>(title: <span class="string">&quot;Button taps&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> view <span class="operator">=</span> <span class="type">VStack</span>(spacing: <span class="number">100</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">Button</span>(action: &#123; subject.send() &#125;) &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">&quot;Press me within 5 seconds&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    timeline</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">timedOutSubject.displayEvents(in: timeline)</span><br><span class="line"></span><br><span class="line"><span class="type">PlaygroundPage</span>.current.liveView <span class="operator">=</span> <span class="type">UIHostingController</span>(rootView: view.frame(width: <span class="number">600</span>, height: <span class="number">600</span>))</span><br></pre></td></tr></table></figure>

<h3 id="measureInterval-using-options"><a href="#measureInterval-using-options" class="headerlink" title="measureInterval(using:options:)"></a><a target="_blank" rel="noopener" href="https://medium.com/swlh/operators-b8405cb9e265">measureInterval(using:options:)</a></h3><ul>
<li>測量並行出從上游發佈者接收到的事件之間的時間間隔…</li>
<li>可以看出時間間隔大約就是一秒</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> cancellable <span class="operator">=</span> <span class="type">Timer</span>.publish(every: <span class="number">1</span>, on: .main, in: .default)</span><br><span class="line">    .autoconnect()</span><br><span class="line">    .measureInterval(using: <span class="type">RunLoop</span>.main)</span><br><span class="line">    .sink &#123; <span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>, terminator: <span class="string">&quot;<span class="subst">\n</span>&quot;</span>) &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Stride(magnitude: 1.0004009008407593)</span><br><span class="line">Stride(magnitude: 1.0000990629196167)</span><br><span class="line">Stride(magnitude: 1.0000349283218384)</span><br><span class="line">Stride(magnitude: 1.0007370710372925)</span><br><span class="line">Stride(magnitude: 1.0000169277191162)</span><br><span class="line">Stride(magnitude: 0.9993090629577637)</span><br><span class="line">Stride(magnitude: 0.9999560117721558)</span><br><span class="line">Stride(magnitude: 1.0000669956207275)</span><br><span class="line">Stride(magnitude: 0.9999699592590332)</span><br></pre></td></tr></table></figure>

<ul>
<li>圖文版加強版<br><img src="/../../source/images/Study_Combine/MeasureInterval.png"></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> subject <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">String</span>, <span class="type">Never</span>&gt;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> measureSubject <span class="operator">=</span> subject.measureInterval(using: <span class="type">DispatchQueue</span>.main)</span><br><span class="line"><span class="keyword">let</span> measureSubject2 <span class="operator">=</span> subject.measureInterval(using: <span class="type">RunLoop</span>.main)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subjectTimeline <span class="operator">=</span> <span class="type">TimelineView</span>(title: <span class="string">&quot;Emitted values&quot;</span>)</span><br><span class="line"><span class="keyword">let</span> measureTimeline <span class="operator">=</span> <span class="type">TimelineView</span>(title: <span class="string">&quot;Measured values&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> view <span class="operator">=</span> <span class="type">VStack</span>(spacing: <span class="number">100</span>) &#123;</span><br><span class="line">    subjectTimeline</span><br><span class="line">    measureTimeline</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">subject.displayEvents(in: subjectTimeline)</span><br><span class="line">measureSubject.displayEvents(in: measureTimeline)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subscription1 <span class="operator">=</span> subject.sink &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;+<span class="subst">\(deltaTime)</span>s: Subject emitted: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subscription2 <span class="operator">=</span> measureSubject.sink &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;+<span class="subst">\(deltaTime)</span>s: Measure emitted: <span class="subst">\(Double(<span class="variable">$0</span>.magnitude) <span class="operator">/</span> <span class="number">1_000_000_000.0</span>)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> subscription3 <span class="operator">=</span> measureSubject2.sink &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;+<span class="subst">\(deltaTime)</span>s: Measure2 emitted: <span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">subject.feed(with: typingHelloWorld)</span><br><span class="line"></span><br><span class="line"><span class="type">PlaygroundPage</span>.current.liveView <span class="operator">=</span> <span class="type">UIHostingController</span>(rootView: view.frame(width: <span class="number">375</span>, height: <span class="number">600</span>))</span><br></pre></td></tr></table></figure>

<h2 id="Lesson-06-序列用運算子"><a href="#Lesson-06-序列用運算子" class="headerlink" title="Lesson.06 - 序列用運算子"></a>Lesson.06 - 序列用運算子</h2><h3 id="最小值-min-最大值-max"><a href="#最小值-min-最大值-max" class="headerlink" title="最小值 - min() &#x2F; 最大值 - max()"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7020306845646454820">最小值 - min() &#x2F; 最大值 - max()</a></h3><ul>
<li>取最小值</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;min()&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="number">1</span>, <span class="operator">-</span><span class="number">50</span>, <span class="number">246</span>, <span class="number">0</span>].publisher</span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .print(<span class="string">&quot;publisher&quot;</span>)</span><br><span class="line">        .min()</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;最小值：<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: min() ===</span><br><span class="line">publisher: receive subscription: ([1, -50, 246, 0])</span><br><span class="line">publisher: request unlimited</span><br><span class="line">publisher: receive value: (1)</span><br><span class="line">publisher: receive value: (-50)</span><br><span class="line">publisher: receive value: (246)</span><br><span class="line">publisher: receive value: (0)</span><br><span class="line">publisher: receive finished</span><br><span class="line">最小值：-50</span><br></pre></td></tr></table></figure>

<ul>
<li>取最小值 (自訂過濾條件)</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;min non-Comparable&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="string">&quot;12345&quot;</span>, <span class="string">&quot;ab&quot;</span>, <span class="string">&quot;hello world&quot;</span>]</span><br><span class="line">        .map &#123; <span class="type">Data</span>(<span class="variable">$0</span>.utf8) &#125;</span><br><span class="line">        .publisher</span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .print(<span class="string">&quot;publisher&quot;</span>)</span><br><span class="line">        .min &#123; <span class="variable">$0</span>.count <span class="operator">&lt;</span> <span class="variable">$1</span>.count &#125;</span><br><span class="line">        .sink &#123; data <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> string <span class="operator">=</span> <span class="type">String</span>(data: data, encoding: .utf8) <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;最小資料的是 <span class="subst">\(string)</span>, <span class="subst">\(string.count)</span> bytes&quot;</span>)</span><br><span class="line">        &#125;.store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: min non-Comparable ===</span><br><span class="line">publisher: receive subscription: ([5 bytes, 2 bytes, 11 bytes])</span><br><span class="line">publisher: request unlimited</span><br><span class="line">publisher: receive value: (5 bytes)</span><br><span class="line">publisher: receive value: (2 bytes)</span><br><span class="line">publisher: receive value: (11 bytes)</span><br><span class="line">publisher: receive finished</span><br><span class="line">最小資料的是 ab, 2 bytes</span><br></pre></td></tr></table></figure>

<ul>
<li>取最大值</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;max()&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;E&quot;</span>].publisher</span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .print(<span class="string">&quot;publisher&quot;</span>)</span><br><span class="line">        .max()</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;最大值：<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: max() ===</span><br><span class="line">publisher: receive subscription: ([<span class="string">&quot;A&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;E&quot;</span>])</span><br><span class="line">publisher: request unlimited</span><br><span class="line">publisher: receive value: (A)</span><br><span class="line">publisher: receive value: (F)</span><br><span class="line">publisher: receive value: (Z)</span><br><span class="line">publisher: receive value: (E)</span><br><span class="line">publisher: receive finished</span><br><span class="line">最大值：Z</span><br></pre></td></tr></table></figure>

<ul>
<li>取最大值 (要發佈結束，不然會一直等下去)</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;max()&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> <span class="type">PassthroughSubject</span>&lt;<span class="type">Int</span>, <span class="type">Never</span>&gt;()</span><br><span class="line">    </span><br><span class="line">    publisher</span><br><span class="line">        .print(<span class="string">&quot;publisher&quot;</span>)</span><br><span class="line">        .max()</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;最大值：<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">    </span><br><span class="line">    publisher.send(<span class="number">1</span>)</span><br><span class="line">    publisher.send(<span class="number">2</span>)</span><br><span class="line">    publisher.send(completion: .finished)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: max() ===</span><br><span class="line">publisher: receive subscription: (PassthroughSubject)</span><br><span class="line">publisher: request unlimited</span><br><span class="line">publisher: receive value: (1)</span><br><span class="line">publisher: receive value: (2)</span><br><span class="line">publisher: receive finished</span><br><span class="line">最大值：2</span><br></pre></td></tr></table></figure>

<h3 id="第一個值-first-最後一個值-last"><a href="#第一個值-first-最後一個值-last" class="headerlink" title="第一個值 - first() &#x2F; 最後一個值 - last()"></a><a target="_blank" rel="noopener" href="https://juejin.cn/post/7020308230341410852">第一個值 - first() &#x2F; 最後一個值 - last()</a></h3><ul>
<li>取第一個值</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;first()&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;E&quot;</span>].publisher</span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .print(<span class="string">&quot;publisher&quot;</span>)</span><br><span class="line">        .first()</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;第一個值：<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: first() ===</span><br><span class="line">publisher: receive subscription: ([<span class="string">&quot;A&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;E&quot;</span>])</span><br><span class="line">publisher: request unlimited</span><br><span class="line">publisher: receive value: (A)</span><br><span class="line">publisher: receive cancel</span><br><span class="line">第一個值：A</span><br></pre></td></tr></table></figure>

<ul>
<li>取第一個值 (自訂過濾條件)</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;first(where:)&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="string">&quot;J&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;N&quot;</span>].publisher</span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .print(<span class="string">&quot;publisher&quot;</span>)</span><br><span class="line">        .first(where: &#123; <span class="string">&quot;Hello World&quot;</span>.contains(<span class="variable">$0</span>) &#125;)</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;符合條件的第一個值：<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: first(<span class="built_in">where</span>:) ===</span><br><span class="line">publisher: receive subscription: ([<span class="string">&quot;J&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;N&quot;</span>])</span><br><span class="line">publisher: request unlimited</span><br><span class="line">publisher: receive value: (J)</span><br><span class="line">publisher: receive value: (O)</span><br><span class="line">publisher: receive value: (H)</span><br><span class="line">publisher: receive cancel</span><br><span class="line">符合條件的第一個值：H</span><br></pre></td></tr></table></figure>

<ul>
<li>取最後一個值</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;last()&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;U&quot;</span>].publisher</span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .print(<span class="string">&quot;publisher&quot;</span>)</span><br><span class="line">        .last()</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;最後一個值：<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: last() ===</span><br><span class="line">publisher: receive subscription: ([<span class="string">&quot;A&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;U&quot;</span>])</span><br><span class="line">publisher: request unlimited</span><br><span class="line">publisher: receive value: (A)</span><br><span class="line">publisher: receive value: (E)</span><br><span class="line">publisher: receive value: (I)</span><br><span class="line">publisher: receive value: (O)</span><br><span class="line">publisher: receive value: (U)</span><br><span class="line">publisher: receive finished</span><br><span class="line">最後一個值：U</span><br></pre></td></tr></table></figure>

<h3 id="取某一個值-output-at-取某區間的值-output-in"><a href="#取某一個值-output-at-取某區間的值-output-in" class="headerlink" title="取某一個值 - output(at:) &#x2F; 取某區間的值 - output(in:)"></a><a target="_blank" rel="noopener" href="https://www.kodeco.com/books/combine-asynchronous-programming-with-swift/v3.0/chapters/5-combining-operators">取某一個值 - output(at:) &#x2F; 取某區間的值 - output(in:)</a></h3><ul>
<li>取某一個值</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;output(at:)&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;U&quot;</span>].publisher</span><br><span class="line">    <span class="keyword">let</span> index <span class="operator">=</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .print(<span class="string">&quot;publisher&quot;</span>)</span><br><span class="line">        .output(at: index)</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;index = <span class="subst">\(index)</span>的值：<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: output(at:) ===</span><br><span class="line">publisher: receive subscription: ([<span class="string">&quot;A&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;U&quot;</span>])</span><br><span class="line">publisher: request unlimited</span><br><span class="line">publisher: receive value: (A)</span><br><span class="line">publisher: request max: (1) (synchronous)</span><br><span class="line">publisher: receive value: (E)</span><br><span class="line">publisher: request max: (1) (synchronous)</span><br><span class="line">publisher: receive value: (I)</span><br><span class="line">index = 2的值：I</span><br><span class="line">publisher: receive cancel</span><br></pre></td></tr></table></figure>

<ul>
<li>取某區間的值</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;output(in:)&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;U&quot;</span>].publisher</span><br><span class="line">    <span class="keyword">let</span> range <span class="operator">=</span> <span class="number">1</span><span class="operator">...</span><span class="number">3</span></span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .output(in: range)</span><br><span class="line">        .sink(</span><br><span class="line">            receiveCompletion: &#123; <span class="built_in">print</span>(<span class="variable">$0</span>) &#125;,</span><br><span class="line">            receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;區間內的值：<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: output(<span class="keyword">in</span>:) ===</span><br><span class="line">區間內的值：E</span><br><span class="line">區間內的值：I</span><br><span class="line">區間內的值：O</span><br><span class="line">finished</span><br></pre></td></tr></table></figure>

<h3 id="取得數量-count"><a href="#取得數量-count" class="headerlink" title="取得數量 - count()"></a><a target="_blank" rel="noopener" href="https://betterprogramming.pub/7-sequential-operators-you-should-know-from-swift-combine-1775ce3c47c8">取得數量 - count()</a></h3><ul>
<li>取得數量</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;count()&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>].publisher</span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .print(<span class="string">&quot;publisher&quot;</span>)</span><br><span class="line">        .count()</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;有<span class="subst">\(<span class="variable">$0</span>)</span>個項目&quot;</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: count() ===</span><br><span class="line">publisher: receive subscription: ([<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>])</span><br><span class="line">publisher: request unlimited</span><br><span class="line">publisher: receive value: (A)</span><br><span class="line">publisher: receive value: (B)</span><br><span class="line">publisher: receive value: (C)</span><br><span class="line">publisher: receive finished</span><br><span class="line">有3個項目</span><br></pre></td></tr></table></figure>

<h3 id="處理包含的值-contains-contains-where"><a href="#處理包含的值-contains-contains-where" class="headerlink" title="處理包含的值 - contains() &#x2F; contains(where:)"></a><a target="_blank" rel="noopener" href="https://paigeshin1991.medium.com/swift-combine-contains-operator-f47a213b6870">處理包含的值 - contains() &#x2F; contains(where:)</a></h3><ul>
<li>處理包含的值</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;contains()&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>].publisher</span><br><span class="line">    <span class="keyword">let</span> letter <span class="operator">=</span> <span class="string">&quot;C&quot;</span></span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .print(<span class="string">&quot;publisher&quot;</span>)</span><br><span class="line">        .contains(letter)</span><br><span class="line">        .sink(receiveValue: &#123; isContains <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(isContains <span class="operator">?</span> <span class="string">&quot;Publisher包含 - <span class="subst">\(letter)</span>&quot;</span> : <span class="string">&quot;Publisher不包含 - <span class="subst">\(letter)</span>!&quot;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: contains() ===</span><br><span class="line">publisher: receive subscription: ([<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>])</span><br><span class="line">publisher: request unlimited</span><br><span class="line">publisher: receive value: (A)</span><br><span class="line">publisher: receive value: (B)</span><br><span class="line">publisher: receive value: (C)</span><br><span class="line">publisher: receive cancel</span><br><span class="line">Publisher包含 - C</span><br></pre></td></tr></table></figure>

<ul>
<li>處理包含的值 (自訂過濾條件)</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;contains(where:)&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> id: <span class="type">Int</span></span><br><span class="line">        <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> people <span class="operator">=</span> [(<span class="number">123</span>, <span class="string">&quot;Shai Mishali&quot;</span>), (<span class="number">777</span>, <span class="string">&quot;Marin Todorov&quot;</span>), (<span class="number">214</span>, <span class="string">&quot;Florent Pillet&quot;</span>)]</span><br><span class="line">        .map(<span class="type">Person</span>.<span class="keyword">init</span>)</span><br><span class="line">        .publisher</span><br><span class="line"></span><br><span class="line">    people</span><br><span class="line">        .contains(where: &#123; <span class="variable">$0</span>.id <span class="operator">==</span> <span class="number">800</span> <span class="operator">||</span> <span class="variable">$0</span>.name <span class="operator">==</span> <span class="string">&quot;Marin Todorov&quot;</span> &#125;)</span><br><span class="line">        .sink(receiveValue: &#123; isContains <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(isContains <span class="operator">?</span> <span class="string">&quot;有找到符合條件的值&quot;</span> : <span class="string">&quot;沒有找到符合條件的值&quot;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: contains(<span class="built_in">where</span>:) ===</span><br><span class="line">有找到符合條件的值</span><br></pre></td></tr></table></figure>

<h3 id="找到所有符合條件的值-allSatisfy"><a href="#找到所有符合條件的值-allSatisfy" class="headerlink" title="找到所有符合條件的值 - allSatisfy()"></a><a target="_blank" rel="noopener" href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swift-%E9%9B%86%E5%90%88%E7%9A%84-contains-allsatisfy-%E5%88%A4%E6%96%B7-%E9%9B%86%E5%90%88%E8%A3%A1%E7%9A%84%E6%9D%B1%E8%A5%BF%E6%98%AF%E5%90%A6%E7%AC%A6%E5%90%88%E6%A2%9D%E4%BB%B6-35adc54ed397">找到所有符合條件的值 - allSatisfy()</a></h3><ul>
<li>找到所有符合條件的值</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;allSatisfy()&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> <span class="built_in">stride</span>(from: <span class="number">0</span>, to: <span class="number">5</span>, by: <span class="number">1</span>).publisher</span><br><span class="line">    <span class="keyword">let</span> condition: (<span class="type">Int</span>) -&gt; <span class="type">Bool</span> <span class="operator">=</span> &#123; <span class="variable">$0</span> <span class="operator">%</span> <span class="number">2</span> <span class="operator">==</span> <span class="number">0</span> &#125;</span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .print(<span class="string">&quot;publisher&quot;</span>)</span><br><span class="line">        .allSatisfy &#123; condition(<span class="variable">$0</span>) &#125;</span><br><span class="line">        .sink(receiveValue: &#123; isAllEven <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(isAllEven <span class="operator">?</span> <span class="string">&quot;全部都是偶數&quot;</span> : <span class="string">&quot;不全都是偶數&quot;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: allSatisfy() ===</span><br><span class="line">publisher: receive subscription: (Sequence)</span><br><span class="line">publisher: request unlimited</span><br><span class="line">publisher: receive value: (0)</span><br><span class="line">publisher: receive value: (1)</span><br><span class="line">publisher: receive cancel</span><br><span class="line">不全都是偶數</span><br></pre></td></tr></table></figure>

<ul>
<li><a target="_blank" rel="noopener" href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/array-%E7%9A%84%E9%AB%98%E9%9A%8E%E5%87%BD%E5%BC%8F-filter-map-and-reduce-39fb8ba5a9f7">依照條件合併</a></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(of: <span class="string">&quot;reduce()&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> publisher <span class="operator">=</span> [<span class="string">&quot;Hel&quot;</span>, <span class="string">&quot;lo&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;Wor&quot;</span>, <span class="string">&quot;ld&quot;</span>, <span class="string">&quot;!&quot;</span>].publisher</span><br><span class="line"></span><br><span class="line">    publisher</span><br><span class="line">        .print(<span class="string">&quot;publisher&quot;</span>)</span><br><span class="line">        .reduce(<span class="string">&quot;&quot;</span>, <span class="operator">+</span>)</span><br><span class="line">        .sink(receiveValue: &#123; <span class="built_in">print</span>(<span class="string">&quot;合併為：<span class="subst">\(<span class="variable">$0</span>)</span>&quot;</span>) &#125;)</span><br><span class="line">        .store(in: <span class="operator">&amp;</span>subscriptions)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">=== 範例: reduce() ===</span><br><span class="line">publisher: receive subscription: ([<span class="string">&quot;Hel&quot;</span>, <span class="string">&quot;lo&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;Wor&quot;</span>, <span class="string">&quot;ld&quot;</span>, <span class="string">&quot;!&quot;</span>])</span><br><span class="line">publisher: request unlimited</span><br><span class="line">publisher: receive value: (Hel)</span><br><span class="line">publisher: receive value: (lo)</span><br><span class="line">publisher: receive value: ( )</span><br><span class="line">publisher: receive value: (Wor)</span><br><span class="line">publisher: receive value: (ld)</span><br><span class="line">publisher: receive value: (!)</span><br><span class="line">publisher: receive finished</span><br><span class="line">合併為：Hello World!</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://shxlxa.github.io">shxlxa</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://shxlxa.github.io/2024/09/01/Swift/Study_Combine/">https://shxlxa.github.io/2024/09/01/Swift/Study_Combine/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://shxlxa.github.io" target="_blank">shxlxa</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/combine/">combine</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/10/22/Swift/SwiftData/" title="SwiftData详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">SwiftData详解</div></div></a></div><div class="next-post pull-right"><a href="/2024/03/03/%E7%BD%91%E7%BB%9C/DNS%20%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/" title="DNS 域名解析"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">DNS 域名解析</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">shxlxa</div><div class="author-info__description">This is my blog</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/shxlxa"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Swift-Combine-iOS-13"><span class="toc-number">1.</span> <span class="toc-text">Swift Combine - iOS 13</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%89%E7%A7%BB%E5%88%B0-Combine"><span class="toc-number">1.1.</span> <span class="toc-text">轉移到 Combine</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lesson-01-Notification-vs-Combine"><span class="toc-number">1.2.</span> <span class="toc-text">Lesson.01 - Notification vs Combine</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E7%9F%A5-Notification"><span class="toc-number">1.2.1.</span> <span class="toc-text">通知 - Notification</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BC%E5%B8%83%E8%80%85-Publisher"><span class="toc-number">1.2.2.</span> <span class="toc-text">發布者 - Publisher</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A8%82%E9%96%B1%E8%80%85-Subscriber"><span class="toc-number">1.2.3.</span> <span class="toc-text">訂閱者 - Subscriber</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E5%BF%83%E4%B8%AD%E7%9A%84Combine"><span class="toc-number">1.3.</span> <span class="toc-text">我心中的Combine</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E5%AD%B8Publisher"><span class="toc-number">1.4.</span> <span class="toc-text">初學Publisher</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Just"><span class="toc-number">1.4.1.</span> <span class="toc-text">Just</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Combine%E9%81%8B%E7%AE%97%E5%AD%90"><span class="toc-number">1.5.</span> <span class="toc-text">Combine運算子</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%84%B2%E5%AD%98%E6%95%B8%E5%80%BC-assign-to-on"><span class="toc-number">1.5.1.</span> <span class="toc-text">儲存數值 - assign(to:on:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%84%B2%E5%AD%98%E6%95%B8%E5%80%BC-assign-to"><span class="toc-number">1.5.2.</span> <span class="toc-text">儲存數值 - assign(to:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E8%A8%82Subscriber"><span class="toc-number">1.5.3.</span> <span class="toc-text">自訂Subscriber</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Publisher"><span class="toc-number">1.6.</span> <span class="toc-text">Publisher</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Future-%E9%9D%9E%E5%90%8C%E6%AD%A5Publisher"><span class="toc-number">1.6.1.</span> <span class="toc-text">Future - 非同步Publisher</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Subject-Publisher-%E5%BB%B6%E5%B1%95%E9%A1%9E"><span class="toc-number">1.7.</span> <span class="toc-text">Subject - Publisher 延展類</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PassthroughSubject"><span class="toc-number">1.7.1.</span> <span class="toc-text">PassthroughSubject</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CurrentValueSubject-Publisher-%E5%BB%B6%E5%B1%95%E9%A1%9E"><span class="toc-number">1.7.2.</span> <span class="toc-text">CurrentValueSubject - Publisher 延展類</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8B%95%E6%A0%A1%E6%AD%A3Demand"><span class="toc-number">1.7.3.</span> <span class="toc-text">自動校正Demand</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eraseToAnyPublisher"><span class="toc-number">1.7.4.</span> <span class="toc-text">eraseToAnyPublisher()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#async-await"><span class="toc-number">1.7.5.</span> <span class="toc-text">async &#x2F; await</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lesson-02-Operators%E4%B9%9F%E6%98%AFPublisher"><span class="toc-number">1.8.</span> <span class="toc-text">Lesson.02 - Operators也是Publisher</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#collect"><span class="toc-number">1.8.1.</span> <span class="toc-text">collect()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#map"><span class="toc-number">1.8.2.</span> <span class="toc-text">map()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tryMap"><span class="toc-number">1.8.3.</span> <span class="toc-text">tryMap()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flatMap"><span class="toc-number">1.8.4.</span> <span class="toc-text">flatMap()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#replaceNil-with"><span class="toc-number">1.8.5.</span> <span class="toc-text">replaceNil(with:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#replaceEmpty-with"><span class="toc-number">1.8.6.</span> <span class="toc-text">replaceEmpty(with:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scan-https-juejin-cn-s-swift-combine-scan-example"><span class="toc-number">1.8.7.</span> <span class="toc-text">[scan()](https:&#x2F;&#x2F;juejin.cn&#x2F;s&#x2F;swift combine scan example)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lesson-03-%E9%81%8E%E6%BF%BE%E7%94%A8%E7%9A%84Operator"><span class="toc-number">1.9.</span> <span class="toc-text">Lesson.03 - 過濾用的Operator</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#filter"><span class="toc-number">1.9.1.</span> <span class="toc-text">filter()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#removeDuplicates"><span class="toc-number">1.9.2.</span> <span class="toc-text">removeDuplicates()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#compactMap"><span class="toc-number">1.9.3.</span> <span class="toc-text">compactMap()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ignoreOutput"><span class="toc-number">1.9.4.</span> <span class="toc-text">ignoreOutput()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#first-where"><span class="toc-number">1.9.5.</span> <span class="toc-text">first(where:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#last-where"><span class="toc-number">1.9.6.</span> <span class="toc-text">last(where:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dropFirst"><span class="toc-number">1.9.7.</span> <span class="toc-text">dropFirst()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#drop-while"><span class="toc-number">1.9.8.</span> <span class="toc-text">drop(while:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#drop-while-1"><span class="toc-number">1.9.9.</span> <span class="toc-text">drop(while:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prefix-while"><span class="toc-number">1.9.10.</span> <span class="toc-text">prefix(while:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prefix-while-1"><span class="toc-number">1.9.11.</span> <span class="toc-text">prefix(while:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prefix-untilOutputFrom"><span class="toc-number">1.9.12.</span> <span class="toc-text">prefix(untilOutputFrom:)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lesson-04-%E7%B5%90%E5%90%88%E7%94%A8%E7%9A%84Operator"><span class="toc-number">1.10.</span> <span class="toc-text">Lesson.04 - 結合用的Operator</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#prepend-Output%E2%80%A6"><span class="toc-number">1.10.1.</span> <span class="toc-text">prepend(Output…)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prepend-Sequence"><span class="toc-number">1.10.2.</span> <span class="toc-text">prepend(Sequence)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prepend-Publisher"><span class="toc-number">1.10.3.</span> <span class="toc-text">prepend(Publisher)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#append-Output%E2%80%A6"><span class="toc-number">1.10.4.</span> <span class="toc-text">append(Output…)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#append-Sequence"><span class="toc-number">1.10.5.</span> <span class="toc-text">append(Sequence)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#append-Publisher"><span class="toc-number">1.10.6.</span> <span class="toc-text">append(Publisher)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#switchToLatest"><span class="toc-number">1.10.7.</span> <span class="toc-text">switchToLatest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#merge-with"><span class="toc-number">1.10.8.</span> <span class="toc-text">merge(with:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#combineLatest"><span class="toc-number">1.10.9.</span> <span class="toc-text">combineLatest()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zip"><span class="toc-number">1.10.10.</span> <span class="toc-text">zip()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lesson-05-%E6%99%82%E9%96%93%E6%93%8D%E4%BD%9C%E9%81%8B%E7%AE%97%E5%AD%90"><span class="toc-number">1.11.</span> <span class="toc-text">Lesson.05 - 時間操作運算子</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#delay-for-tolerance-scheduler-options"><span class="toc-number">1.11.1.</span> <span class="toc-text">delay(for:tolerance:scheduler:options)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#collect-1"><span class="toc-number">1.11.2.</span> <span class="toc-text">collect()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#debounce"><span class="toc-number">1.11.3.</span> <span class="toc-text">debounce()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#throttle-for-scheduler-latest"><span class="toc-number">1.11.4.</span> <span class="toc-text">throttle(for:scheduler:latest:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#timeout-scheduler-options-customError"><span class="toc-number">1.11.5.</span> <span class="toc-text">timeout(_:scheduler:options:customError:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#measureInterval-using-options"><span class="toc-number">1.11.6.</span> <span class="toc-text">measureInterval(using:options:)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lesson-06-%E5%BA%8F%E5%88%97%E7%94%A8%E9%81%8B%E7%AE%97%E5%AD%90"><span class="toc-number">1.12.</span> <span class="toc-text">Lesson.06 - 序列用運算子</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E5%80%BC-min-%E6%9C%80%E5%A4%A7%E5%80%BC-max"><span class="toc-number">1.12.1.</span> <span class="toc-text">最小值 - min() &#x2F; 最大值 - max()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%80%8B%E5%80%BC-first-%E6%9C%80%E5%BE%8C%E4%B8%80%E5%80%8B%E5%80%BC-last"><span class="toc-number">1.12.2.</span> <span class="toc-text">第一個值 - first() &#x2F; 最後一個值 - last()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E6%9F%90%E4%B8%80%E5%80%8B%E5%80%BC-output-at-%E5%8F%96%E6%9F%90%E5%8D%80%E9%96%93%E7%9A%84%E5%80%BC-output-in"><span class="toc-number">1.12.3.</span> <span class="toc-text">取某一個值 - output(at:) &#x2F; 取某區間的值 - output(in:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E5%BE%97%E6%95%B8%E9%87%8F-count"><span class="toc-number">1.12.4.</span> <span class="toc-text">取得數量 - count()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%95%E7%90%86%E5%8C%85%E5%90%AB%E7%9A%84%E5%80%BC-contains-contains-where"><span class="toc-number">1.12.5.</span> <span class="toc-text">處理包含的值 - contains() &#x2F; contains(where:)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E6%89%80%E6%9C%89%E7%AC%A6%E5%90%88%E6%A2%9D%E4%BB%B6%E7%9A%84%E5%80%BC-allSatisfy"><span class="toc-number">1.12.6.</span> <span class="toc-text">找到所有符合條件的值 - allSatisfy()</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/15/flutter/flutter_command_cheatsheet/" title="Flutter 命令行速查表">Flutter 命令行速查表</a><time datetime="2025-06-15T10:09:33.000Z" title="发表于 2025-06-15 18:09:33">2025-06-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/11/Swift/Swift%20%E4%B8%AD%E5%B8%B8%E7%94%A8%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0%E4%BB%8B%E7%BB%8D/" title="Swift 中常用高阶函数介绍">Swift 中常用高阶函数介绍</a><time datetime="2025-05-11T09:40:43.000Z" title="发表于 2025-05-11 17:40:43">2025-05-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/08/Swift/swift%20%E5%8F%8D%E5%B0%84/" title="swift 反射">swift 反射</a><time datetime="2025-05-08T11:09:43.000Z" title="发表于 2025-05-08 19:09:43">2025-05-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/06/Swift/%E6%B5%8B%E8%AF%95%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%B9%B6%E5%8F%91%E8%AF%B7%E6%B1%82/" title="测试多线程并发请求">测试多线程并发请求</a><time datetime="2025-04-06T03:09:43.000Z" title="发表于 2025-04-06 11:09:43">2025-04-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/14/Swift/Swift%E5%B7%A5%E7%A8%8B%E6%9E%84%E5%BB%BATest%E5%92%8Crelease%E7%8E%AF%E5%A2%83/" title="Swift工程构建Test和release环境">Swift工程构建Test和release环境</a><time datetime="2025-03-14T14:53:43.000Z" title="发表于 2025-03-14 22:53:43">2025-03-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By shxlxa</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>